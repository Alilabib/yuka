/*

 The MIT License

 Copyright  2018 Yuka authors

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.

*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,f,h){d!=Array.prototype&&d!=Object.prototype&&(d[f]=h.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var d=0;return function(f){return $jscomp.SYMBOL_PREFIX+(f||"")+d++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(d){var f=0;return $jscomp.iteratorPrototype(function(){return f<d.length?{done:!1,value:d[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};$jscomp.makeIterator=function(d){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=d[Symbol.iterator];return f?f.call(d):$jscomp.arrayIterator(d)};$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(d){var f=function(){};f.prototype=d;return new f};
$jscomp.underscoreProtoCanBeSet=function(){var d={a:!0},f={};try{return f.__proto__=d,f.a}catch(h){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(d,f){d.__proto__=f;if(d.__proto__!==f)throw new TypeError(d+" is not extensible");return d}:null;
$jscomp.inherits=function(d,f){d.prototype=$jscomp.objectCreate(f.prototype);d.prototype.constructor=d;if($jscomp.setPrototypeOf){var h=$jscomp.setPrototypeOf;h(d,f)}else for(h in f)if("prototype"!=h)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(f,h);r&&Object.defineProperty(d,h,r)}else d[h]=f[h];d.superClass_=f.prototype};$jscomp.arrayFromIterator=function(d){for(var f,h=[];!(f=d.next()).done;)h.push(f.value);return h};
$jscomp.arrayFromIterable=function(d){return d instanceof Array?d:$jscomp.arrayFromIterator($jscomp.makeIterator(d))};$jscomp.polyfill=function(d,f,h,r){if(f){h=$jscomp.global;d=d.split(".");for(r=0;r<d.length-1;r++){var n=d[r];n in h||(h[n]={});h=h[n]}d=d[d.length-1];r=h[d];f=f(r);f!=r&&null!=f&&$jscomp.defineProperty(h,d,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Number.EPSILON",function(d){return Math.pow(2,-52)},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var d={},f=Object.create(new $jscomp.global.Proxy(d,{get:function(h,r,n){return h==d&&"q"==r&&n==f}}));return!0===f.q}catch(h){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(d,f){return Object.prototype.hasOwnProperty.call(d,f)};
$jscomp.polyfill("WeakMap",function(d){function f(){if(!d||!Object.seal)return!1;try{var l=Object.seal({}),m=Object.seal({}),f=new d([[l,2],[m,3]]);if(2!=f.get(l)||3!=f.get(m))return!1;f.delete(l);f.set(m,4);return!f.has(l)&&4==f.get(m)}catch(v){return!1}}function h(d){$jscomp.owns(d,n)||$jscomp.defineProperty(d,n,{value:{}})}function r(d){var m=Object[d];m&&(Object[d]=function(d){h(d);return m(d)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(d&&$jscomp.ES6_CONFORMANCE)return d}else if(f())return d;
var n="$jscomp_hidden_"+Math.random();r("freeze");r("preventExtensions");r("seal");var F=0,l=function(d){this.id_=(F+=Math.random()+1).toString();if(d){$jscomp.initSymbol();$jscomp.initSymbolIterator();d=$jscomp.makeIterator(d);for(var m;!(m=d.next()).done;)m=m.value,this.set(m[0],m[1])}};l.prototype.set=function(d,m){h(d);if(!$jscomp.owns(d,n))throw Error("WeakMap key fail: "+d);d[n][this.id_]=m;return this};l.prototype.get=function(d){return $jscomp.owns(d,n)?d[n][this.id_]:void 0};l.prototype.has=
function(d){return $jscomp.owns(d,n)&&$jscomp.owns(d[n],this.id_)};l.prototype.delete=function(d){return $jscomp.owns(d,n)&&$jscomp.owns(d[n],this.id_)?delete d[n][this.id_]:!1};return l},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(d){function f(){if($jscomp.ASSUME_NO_NATIVE_MAP||!d||"function"!=typeof d||!d.prototype.entries||"function"!=typeof Object.seal)return!1;try{var m=Object.seal({x:4}),l=new d($jscomp.makeIterator([[m,"s"]]));if("s"!=l.get(m)||1!=l.size||l.get({x:4})||l.set({x:4},"t")!=l||2!=l.size)return!1;var v=l.entries(),f=v.next();if(f.done||f.value[0]!=m||"s"!=f.value[1])return!1;f=v.next();return f.done||4!=f.value[0].x||"t"!=f.value[1]||!v.next().done?!1:!0}catch(X){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(d&&$jscomp.ES6_CONFORMANCE)return d}else if(f())return d;$jscomp.initSymbol();$jscomp.initSymbolIterator();var h=new WeakMap,r=function(d){this.data_={};this.head_=l();this.size=0;if(d){d=$jscomp.makeIterator(d);for(var m;!(m=d.next()).done;)m=m.value,this.set(m[0],m[1])}};r.prototype.set=function(d,l){d=0===d?0:d;var m=n(this,d);m.list||(m.list=this.data_[m.id]=[]);m.entry?m.entry.value=l:(m.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:d,value:l},m.list.push(m.entry),this.head_.previous.next=m.entry,this.head_.previous=m.entry,this.size++);return this};r.prototype.delete=function(d){d=n(this,d);return d.entry&&d.list?(d.list.splice(d.index,1),d.list.length||delete this.data_[d.id],d.entry.previous.next=d.entry.next,d.entry.next.previous=d.entry.previous,d.entry.head=null,this.size--,!0):!1};r.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=l();this.size=0};r.prototype.has=function(d){return!!n(this,d).entry};
r.prototype.get=function(d){return(d=n(this,d).entry)&&d.value};r.prototype.entries=function(){return F(this,function(d){return[d.key,d.value]})};r.prototype.keys=function(){return F(this,function(d){return d.key})};r.prototype.values=function(){return F(this,function(d){return d.value})};r.prototype.forEach=function(d,l){for(var f=this.entries(),m;!(m=f.next()).done;)m=m.value,d.call(l,m[1],m[0],this)};r.prototype[Symbol.iterator]=r.prototype.entries;var n=function(d,l){var f=l&&typeof l;"object"==
f||"function"==f?h.has(l)?f=h.get(l):(f=""+ ++fb,h.set(l,f)):f="p_"+l;var m=d.data_[f];if(m&&$jscomp.owns(d.data_,f))for(d=0;d<m.length;d++){var n=m[d];if(l!==l&&n.key!==n.key||l===n.key)return{id:f,list:m,index:d,entry:n}}return{id:f,list:m,index:-1,entry:void 0}},F=function(d,l){var f=d.head_;return $jscomp.iteratorPrototype(function(){if(f){for(;f.head!=d.head_;)f=f.previous;for(;f.next!=f.head;)return f=f.next,{done:!1,value:l(f)};f=null}return{done:!0,value:void 0}})},l=function(){var d={};return d.previous=
d.next=d.head=d},fb=0;return r},"es6","es3");$jscomp.iteratorFromArray=function(d,f){$jscomp.initSymbolIterator();d instanceof String&&(d+="");var h=0,r={next:function(){if(h<d.length){var n=h++;return{value:f(n,d[n]),done:!1}}r.next=function(){return{done:!0,value:void 0}};return r.next()}};r[Symbol.iterator]=function(){return r};return r};$jscomp.polyfill("Array.prototype.values",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d,h){return h})}},"es8","es3");
$jscomp.polyfill("Array.from",function(d){return d?d:function(d,h,r){$jscomp.initSymbolIterator();h=null!=h?h:function(d){return d};var f=[],F=d[Symbol.iterator];if("function"==typeof F){d=F.call(d);for(var l=0;!(F=d.next()).done;)f.push(h.call(r,F.value,l++))}else for(F=d.length,l=0;l<F;l++)f.push(h.call(r,d[l],l));return f}},"es6","es3");$jscomp.polyfill("Array.prototype.entries",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d,h){return[d,h]})}},"es6","es3");
$jscomp.polyfill("Set",function(d){function f(){if($jscomp.ASSUME_NO_NATIVE_SET||!d||"function"!=typeof d||!d.prototype.entries||"function"!=typeof Object.seal)return!1;try{var f=Object.seal({x:4}),n=new d($jscomp.makeIterator([f]));if(!n.has(f)||1!=n.size||n.add(f)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var h=n.entries(),l=h.next();if(l.done||l.value[0]!=f||l.value[1]!=f)return!1;l=h.next();return l.done||l.value[0]==f||4!=l.value[0].x||l.value[1]!=l.value[0]?!1:h.next().done}catch(fb){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(d&&$jscomp.ES6_CONFORMANCE)return d}else if(f())return d;$jscomp.initSymbol();$jscomp.initSymbolIterator();var h=function(d){this.map_=new Map;if(d){d=$jscomp.makeIterator(d);for(var f;!(f=d.next()).done;)this.add(f.value)}this.size=this.map_.size};h.prototype.add=function(d){d=0===d?0:d;this.map_.set(d,d);this.size=this.map_.size;return this};h.prototype.delete=function(d){d=this.map_.delete(d);this.size=this.map_.size;return d};h.prototype.clear=
function(){this.map_.clear();this.size=0};h.prototype.has=function(d){return this.map_.has(d)};h.prototype.entries=function(){return this.map_.entries()};h.prototype.values=function(){return this.map_.values()};h.prototype.keys=h.prototype.values;h.prototype[Symbol.iterator]=h.prototype.values;h.prototype.forEach=function(d,f){var h=this;this.map_.forEach(function(l){return d.call(f,l,l,h)})};return h},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(d){function f(){this.batch_=null}function h(d){return d instanceof n?d:new n(function(f,l){f(d)})}if(d&&!$jscomp.FORCE_POLYFILL_PROMISE)return d;f.prototype.asyncExecute=function(d){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(d);return this};f.prototype.asyncExecuteBatch_=function(){var d=this;this.asyncExecuteFunction(function(){d.executeBatch_()})};var r=$jscomp.global.setTimeout;f.prototype.asyncExecuteFunction=function(d){r(d,
0)};f.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var d=this.batch_;this.batch_=[];for(var f=0;f<d.length;++f){var m=d[f];d[f]=null;try{m()}catch(W){this.asyncThrow_(W)}}}this.batch_=null};f.prototype.asyncThrow_=function(d){this.asyncExecuteFunction(function(){throw d;})};var n=function(d){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var f=this.createResolveAndReject_();try{d(f.resolve,f.reject)}catch(m){f.reject(m)}};n.prototype.createResolveAndReject_=
function(){function d(d){return function(l){m||(m=!0,d.call(f,l))}}var f=this,m=!1;return{resolve:d(this.resolveTo_),reject:d(this.reject_)}};n.prototype.resolveTo_=function(d){if(d===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(d instanceof n)this.settleSameAsPromise_(d);else{a:switch(typeof d){case "object":var f=null!=d;break a;case "function":f=!0;break a;default:f=!1}f?this.resolveToNonPromiseObj_(d):this.fulfill_(d)}};n.prototype.resolveToNonPromiseObj_=function(d){var f=
void 0;try{f=d.then}catch(m){this.reject_(m);return}"function"==typeof f?this.settleSameAsThenable_(f,d):this.fulfill_(d)};n.prototype.reject_=function(d){this.settle_(2,d)};n.prototype.fulfill_=function(d){this.settle_(1,d)};n.prototype.settle_=function(d,f){if(0!=this.state_)throw Error("Cannot settle("+d+", "+f+"): Promise already settled in state"+this.state_);this.state_=d;this.result_=f;this.executeOnSettledCallbacks_()};n.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var d=
0;d<this.onSettledCallbacks_.length;++d)F.asyncExecute(this.onSettledCallbacks_[d]);this.onSettledCallbacks_=null}};var F=new f;n.prototype.settleSameAsPromise_=function(d){var f=this.createResolveAndReject_();d.callWhenSettled_(f.resolve,f.reject)};n.prototype.settleSameAsThenable_=function(d,f){var m=this.createResolveAndReject_();try{d.call(f,m.resolve,m.reject)}catch(W){m.reject(W)}};n.prototype.then=function(d,f){function m(d,f){return"function"==typeof d?function(f){try{l(d(f))}catch(w){h(w)}}:
f}var l,h,r=new n(function(d,f){l=d;h=f});this.callWhenSettled_(m(d,l),m(f,h));return r};n.prototype.catch=function(d){return this.then(void 0,d)};n.prototype.callWhenSettled_=function(d,f){function m(){switch(h.state_){case 1:d(h.result_);break;case 2:f(h.result_);break;default:throw Error("Unexpected state: "+h.state_);}}var h=this;null==this.onSettledCallbacks_?F.asyncExecute(m):this.onSettledCallbacks_.push(m)};n.resolve=h;n.reject=function(d){return new n(function(f,h){h(d)})};n.race=function(d){return new n(function(f,
m){for(var l=$jscomp.makeIterator(d),n=l.next();!n.done;n=l.next())h(n.value).callWhenSettled_(f,m)})};n.all=function(d){var f=$jscomp.makeIterator(d),m=f.next();return m.done?h([]):new n(function(d,n){function l(f){return function(h){r[f]=h;v--;0==v&&d(r)}}var r=[],v=0;do r.push(void 0),v++,h(m.value).callWhenSettled_(l(r.length-1),n),m=f.next();while(!m.done)})};return n},"es6","es3");
(function(d,f){"object"===typeof exports&&"undefined"!==typeof module?f(exports):"function"===typeof define&&define.amd?define(["exports"],f):f(d.YUKA={})})(this,function(d){function f(a){for(var b=[],c=0,e=a.length;c<e;c++)b.push(a[c].uuid);return b}function h(){!0===this.detectPageVisibility&&!1===document.hidden&&(this.currentTime=this.now())}function r(a,b){return a<b?-1:a>b?1:0}function n(a,b){return a.cost<b.cost?-1:a.cost>b.cost?1:0}function F(a,b){return a.cost<b.cost?-1:a.cost>b.cost?1:0}
function l(a,b){return a.cost<b.cost?1:a.cost>b.cost?-1:0}function fb(a,b){return"string"!==typeof a||""===a?"":/^(https?:)?\/\//i.test(a)||/^data:.*,.*$/i.test(a)||/^blob:.*$/i.test(a)?a:b+a}function m(a){for(var b=this.tasks;0<a.timeRemaining()&&0<b.length;)b[0].execute(),b.shift();0<b.length?(this._taskHandle=requestIdleCallback(this._handler,this.options),this._active=!0):(this._taskHandle=0,this._active=!1)}var W=function(a,b,c,e,x){this.sender=a;this.receiver=b;this.message=c;this.delay=e;this.data=
x};W.prototype.toJSON=function(){return{type:this.constructor.name,sender:this.sender?this.sender.uuid:null,receiver:this.receiver?this.receiver.uuid:null,message:this.message,delay:this.delay,data:this.data}};W.prototype.fromJSON=function(a){this.sender=a.sender;this.receiver=a.receiver;this.message=a.message;this.delay=a.delay;this.data=a.data;return this};W.prototype.resolveReferences=function(a){this.sender=a.get(this.sender);this.receiver=a.get(this.receiver);return this};var v=function(){};
v.setLevel=function(a){gb=a};v.log=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];gb<=v.LEVEL.LOG&&console.log.apply(console,$jscomp.arrayFromIterable(b))};v.warn=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];gb<=v.LEVEL.WARN&&console.warn.apply(console,$jscomp.arrayFromIterable(b))};v.error=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];gb<=v.LEVEL.ERROR&&console.error.apply(console,$jscomp.arrayFromIterable(b))};v.LEVEL=
Object.freeze({LOG:0,WARN:1,ERROR:2,SILENT:3});var gb=v.LEVEL.WARN,X=function(){this.delayedTelegrams=[]};X.prototype.deliver=function(a){var b=a.receiver;!1===b.handleMessage(a)&&v.warn("YUKA.MessageDispatcher: Message not handled by receiver: %o",b);return this};X.prototype.dispatch=function(a,b,c,e,x){a=new W(a,b,c,e,x);0>=e?this.deliver(a):this.delayedTelegrams.push(a);return this};X.prototype.dispatchDelayedMessages=function(a){for(var b=this.delayedTelegrams.length;b--;){var c=this.delayedTelegrams[b];
c.delay-=a;0>=c.delay&&(this.deliver(c),this.delayedTelegrams.pop())}return this};X.prototype.clear=function(){this.delayedTelegrams.length=0;return this};X.prototype.toJSON=function(){for(var a={type:this.constructor.name,delayedTelegrams:[]},b=0,c=this.delayedTelegrams.length;b<c;b++)a.delayedTelegrams.push(this.delayedTelegrams[b].toJSON());return a};X.prototype.fromJSON=function(a){this.clear();a=a.delayedTelegrams;for(var b=0,c=a.length;b<c;b++){var e=a[b];e=(new W).fromJSON(e);this.delayedTelegrams.push(e)}return this};
X.prototype.resolveReferences=function(a){for(var b=this.delayedTelegrams,c=0,e=b.length;c<e;c++)b[c].resolveReferences(a);return this};for(var G=[],Pa=0;256>Pa;Pa++)G[Pa]=(16>Pa?"0":"")+Pa.toString(16);var w=function(){};w.clamp=function(a,b,c){return Math.max(b,Math.min(c,a))};w.randInt=function(a,b){return a+Math.floor(Math.random()*(b-a+1))};w.randFloat=function(a,b){return a+Math.random()*(b-a)};w.area=function(a,b,c){return(c.x-a.x)*(b.z-a.z)-(b.x-a.x)*(c.z-a.z)};w.generateUUID=function(){var a=
4294967295*Math.random()|0,b=4294967295*Math.random()|0,c=4294967295*Math.random()|0,e=4294967295*Math.random()|0;return(G[a&255]+G[a>>8&255]+G[a>>16&255]+G[a>>24&255]+"-"+G[b&255]+G[b>>8&255]+"-"+G[b>>16&15|64]+G[b>>24&255]+"-"+G[c&63|128]+G[c>>8&255]+"-"+G[c>>16&255]+G[c>>24&255]+G[e&255]+G[e>>8&255]+G[e>>16&255]+G[e>>24&255]).toUpperCase()};var g=function(a,b,c){this.x=void 0===a?0:a;this.y=void 0===b?0:b;this.z=void 0===c?0:c};g.prototype.set=function(a,b,c){this.x=a;this.y=b;this.z=c;return this};
g.prototype.copy=function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this};g.prototype.clone=function(){return(new this.constructor).copy(this)};g.prototype.add=function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this};g.prototype.addScalar=function(a){this.x+=a;this.y+=a;this.z+=a;return this};g.prototype.addVectors=function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this};g.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this};g.prototype.subScalar=function(a){this.x-=
a;this.y-=a;this.z-=a;return this};g.prototype.subVectors=function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this};g.prototype.multiply=function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;return this};g.prototype.multiplyScalar=function(a){this.x*=a;this.y*=a;this.z*=a;return this};g.prototype.multiplyVectors=function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this};g.prototype.divide=function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this};g.prototype.divideScalar=function(a){this.x/=
a;this.y/=a;this.z/=a;return this};g.prototype.divideVectors=function(a,b){this.x=a.x/b.x;this.y=a.y/b.y;this.z=a.z/b.z;return this};g.prototype.clamp=function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));return this};g.prototype.min=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this};g.prototype.max=function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,
a.y);this.z=Math.max(this.z,a.z);return this};g.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z};g.prototype.cross=function(a){var b=this.x,c=this.y,e=this.z;this.x=c*a.z-e*a.y;this.y=e*a.x-b*a.z;this.z=b*a.y-c*a.x;return this};g.prototype.crossVectors=function(a,b){var c=a.x,e=a.y;a=a.z;var x=b.x,d=b.y;b=b.z;this.x=e*b-a*d;this.y=a*x-c*b;this.z=c*d-e*x;return this};g.prototype.angleTo=function(a){a=this.dot(a)/Math.sqrt(this.squaredLength()*a.squaredLength());return Math.acos(w.clamp(a,
-1,1))};g.prototype.length=function(){return Math.sqrt(this.squaredLength())};g.prototype.squaredLength=function(){return this.dot(this)};g.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)};g.prototype.distanceTo=function(a){return Math.sqrt(this.squaredDistanceTo(a))};g.prototype.squaredDistanceTo=function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a};g.prototype.manhattanDistanceTo=function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-
a.y)+Math.abs(this.z-a.z)};g.prototype.normalize=function(){return this.divideScalar(this.length()||1)};g.prototype.applyMatrix4=function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;var x=1/(a[3]*b+a[7]*c+a[11]*e+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*e+a[12])*x;this.y=(a[1]*b+a[5]*c+a[9]*e+a[13])*x;this.z=(a[2]*b+a[6]*c+a[10]*e+a[14])*x;return this};g.prototype.applyRotation=function(a){var b=this.x,c=this.y,e=this.z,x=a.x,d=a.y,p=a.z;a=a.w;var f=a*b+d*e-p*c,g=a*c+p*b-x*e,y=a*e+x*c-d*b;b=-x*b-d*c-
p*e;this.x=f*a+b*-x+g*-p-y*-d;this.y=g*a+b*-d+y*-x-f*-p;this.z=y*a+b*-p+f*-d-g*-x;return this};g.prototype.extractPositionFromMatrix=function(a){a=a.elements;this.x=a[12];this.y=a[13];this.z=a[14];return this};g.prototype.transformDirection=function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*e;this.y=a[1]*b+a[5]*c+a[9]*e;this.z=a[2]*b+a[6]*c+a[10]*e;return this.normalize()};g.prototype.fromMatrix3Column=function(a,b){return this.fromArray(a.elements,3*b)};g.prototype.fromMatrix4Column=
function(a,b){return this.fromArray(a.elements,4*b)};g.prototype.fromSpherical=function(a,b,c){var e=Math.sin(b)*a;this.x=e*Math.sin(c);this.y=Math.cos(b)*a;this.z=e*Math.cos(c);return this};g.prototype.fromArray=function(a,b){b=void 0===b?0:b;this.x=a[b+0];this.y=a[b+1];this.z=a[b+2];return this};g.prototype.toArray=function(a,b){b=void 0===b?0:b;a[b+0]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a};g.prototype.equals=function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z};var Gb=new g(0,1,0),
Zb=new g,Qa=new g,$b=new g,ac=new g,D=function(){this.elements=[1,0,0,0,1,0,0,0,1]};D.prototype.set=function(a,b,c,e,x,d,p,f,g){var k=this.elements;k[0]=a;k[3]=b;k[6]=c;k[1]=e;k[4]=x;k[7]=d;k[2]=p;k[5]=f;k[8]=g;return this};D.prototype.copy=function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this};D.prototype.clone=function(){return(new this.constructor).copy(this)};D.prototype.identity=function(){this.set(1,
0,0,0,1,0,0,0,1);return this};D.prototype.multiply=function(a){return this.multiplyMatrices(this,a)};D.prototype.premultiply=function(a){return this.multiplyMatrices(a,this)};D.prototype.multiplyMatrices=function(a,b){var c=a.elements,e=b.elements;b=this.elements;a=c[0];var x=c[3],d=c[6],p=c[1],f=c[4],g=c[7],y=c[2],h=c[5];c=c[8];var m=e[0],n=e[3],l=e[6],q=e[1],r=e[4],Hb=e[7],v=e[2],t=e[5];e=e[8];b[0]=a*m+x*q+d*v;b[3]=a*n+x*r+d*t;b[6]=a*l+x*Hb+d*e;b[1]=p*m+f*q+g*v;b[4]=p*n+f*r+g*t;b[7]=p*l+f*Hb+g*
e;b[2]=y*m+h*q+c*v;b[5]=y*n+h*r+c*t;b[8]=y*l+h*Hb+c*e;return this};D.prototype.multiplyScalar=function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this};D.prototype.extractBasis=function(a,b,c){a.fromMatrix3Column(this,0);b.fromMatrix3Column(this,1);c.fromMatrix3Column(this,2);return this};D.prototype.makeBasis=function(a,b,c){this.set(a.x,b.x,c.x,a.y,b.y,c.y,a.z,b.z,c.z);return this};D.prototype.lookAt=function(a,b,c){Zb.crossVectors(c,a).normalize();
Qa.crossVectors(Gb,b).normalize();0===Qa.squaredLength()&&(ac.copy(b).addScalar(Number.EPSILON),Qa.crossVectors(Gb,ac).normalize());$b.crossVectors(b,Qa).normalize();bc.makeBasis(Qa,$b,b);cc.makeBasis(Zb,c,a);this.multiplyMatrices(bc,cc.transpose());return this};D.prototype.transpose=function(){var a=this.elements;var b=a[1];a[1]=a[3];a[3]=b;b=a[2];a[2]=a[6];a[6]=b;b=a[5];a[5]=a[7];a[7]=b;return this};D.prototype.fromQuaternion=function(a){var b=this.elements,c=a.x,e=a.y,x=a.z,d=a.w,p=c+c,f=e+e,g=
x+x;a=c*p;var y=c*f;c*=g;var h=e*f;e*=g;x*=g;p*=d;f*=d;d*=g;b[0]=1-(h+x);b[3]=y-d;b[6]=c+f;b[1]=y+d;b[4]=1-(a+x);b[7]=e-p;b[2]=c-f;b[5]=e+p;b[8]=1-(a+h);return this};D.prototype.fromArray=function(a,b){b=void 0===b?0:b;for(var c=this.elements,e=0;9>e;e++)c[e]=a[e+b];return this};D.prototype.toArray=function(a,b){b=void 0===b?0:b;var c=this.elements;a[b+0]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a};D.prototype.equals=function(a){var b=
this.elements;a=a.elements;for(var c=0;9>c;c++)if(b[c]!==a[c])return!1;return!0};var bc=new D,cc=new D,dc=new D,z=function(a,b,c,e){this.x=void 0===a?0:a;this.y=void 0===b?0:b;this.z=void 0===c?0:c;this.w=void 0===e?1:e};z.prototype.set=function(a,b,c,e){this.x=a;this.y=b;this.z=c;this.w=e;return this};z.prototype.copy=function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this};z.prototype.clone=function(){return(new this.constructor).copy(this)};z.prototype.inverse=function(){return this.conjugate().normalize()};
z.prototype.conjugate=function(){this.x*=-1;this.y*=-1;this.z*=-1;return this};z.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w};z.prototype.length=function(){return Math.sqrt(this.squaredLength())};z.prototype.squaredLength=function(){return this.dot(this)};z.prototype.normalize=function(){var a=this.length();0===a?(this.z=this.y=this.x=0,this.w=1):(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a);return this};z.prototype.multiply=function(a){return this.multiplyQuaternions(this,
a)};z.prototype.premultiply=function(a){return this.multiplyQuaternions(a,this)};z.prototype.multiplyQuaternions=function(a,b){var c=a.x,e=a.y,d=a.z;a=a.w;var k=b.x,p=b.y,f=b.z;b=b.w;this.x=c*b+a*k+e*f-d*p;this.y=e*b+a*p+d*k-c*f;this.z=d*b+a*f+c*p-e*k;this.w=a*b-c*k-e*p-d*f;return this};z.prototype.angleTo=function(a){return 2*Math.acos(Math.abs(w.clamp(this.dot(a),-1,1)))};z.prototype.rotateTo=function(a,b){var c=this.angleTo(a);if(.0001>c)return!0;this.slerp(a,Math.min(1,b/c));return!1};z.prototype.lookAt=
function(a,b,c){dc.lookAt(a,b,c);this.fromMatrix3(dc)};z.prototype.slerp=function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this.x,e=this.y,d=this.z,k=this.w,p=k*a.w+c*a.x+e*a.y+d*a.z;0>p?(this.w=-a.w,this.x=-a.x,this.y=-a.y,this.z=-a.z,p=-p):this.copy(a);if(1<=p)return this.w=k,this.x=c,this.y=e,this.z=d,this;a=Math.sqrt(1-p*p);if(.001>Math.abs(a))return this.w=.5*(k+this.w),this.x=.5*(c+this.x),this.y=.5*(e+this.y),this.z=.5*(d+this.z),this;var f=Math.atan2(a,p);p=Math.sin((1-
b)*f)/a;b=Math.sin(b*f)/a;this.w=k*p+this.w*b;this.x=c*p+this.x*b;this.y=e*p+this.y*b;this.z=d*p+this.z*b;return this};z.prototype.fromEuler=function(a,b,c){var e=Math.cos(a/2),d=Math.cos(b/2),k=Math.cos(c/2);a=Math.sin(a/2);b=Math.sin(b/2);c=Math.sin(c/2);this.x=a*d*k+e*b*c;this.y=e*b*k-a*d*c;this.z=e*d*c+a*b*k;this.w=e*d*k-a*b*c;return this};z.prototype.fromMatrix3=function(a){var b=a.elements,c=b[0];a=b[3];var e=b[6],d=b[1],k=b[4],p=b[7],f=b[2],g=b[5];b=b[8];var y=c+k+b;0<y?(c=.5/Math.sqrt(y+1),
this.w=.25/c,this.x=(g-p)*c,this.y=(e-f)*c,this.z=(d-a)*c):c>k&&c>b?(c=2*Math.sqrt(1+c-k-b),this.w=(g-p)/c,this.x=.25*c,this.y=(a+d)/c,this.z=(e+f)/c):k>b?(c=2*Math.sqrt(1+k-c-b),this.w=(e-f)/c,this.x=(a+d)/c,this.y=.25*c,this.z=(p+g)/c):(c=2*Math.sqrt(1+b-c-k),this.w=(d-a)/c,this.x=(e+f)/c,this.y=(p+g)/c,this.z=.25*c);return this};z.prototype.fromArray=function(a,b){b=void 0===b?0:b;this.x=a[b+0];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this};z.prototype.toArray=function(a,b){b=void 0===
b?0:b;a[b+0]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a};z.prototype.equals=function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w};var A=function(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};A.prototype.set=function(a,b,c,e,d,k,p,f,g,y,h,m,n,l,q,r){var x=this.elements;x[0]=a;x[4]=b;x[8]=c;x[12]=e;x[1]=d;x[5]=k;x[9]=p;x[13]=f;x[2]=g;x[6]=y;x[10]=h;x[14]=m;x[3]=n;x[7]=l;x[11]=q;x[15]=r;return this};A.prototype.copy=function(a){var b=this.elements;a=a.elements;
b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return this};A.prototype.clone=function(){return(new this.constructor).copy(this)};A.prototype.identity=function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this};A.prototype.multiply=function(a){return this.multiplyMatrices(this,a)};A.prototype.premultiply=function(a){return this.multiplyMatrices(a,this)};A.prototype.multiplyMatrices=
function(a,b){var c=a.elements,e=b.elements;b=this.elements;a=c[0];var d=c[4],k=c[8],p=c[12],f=c[1],g=c[5],y=c[9],h=c[13],m=c[2],n=c[6],l=c[10],q=c[14],r=c[3],v=c[7],t=c[11];c=c[15];var u=e[0],z=e[4],A=e[8],B=e[12],hb=e[1],C=e[5],w=e[9],D=e[13],E=e[2],F=e[6],G=e[10],H=e[14],I=e[3],J=e[7],K=e[11];e=e[15];b[0]=a*u+d*hb+k*E+p*I;b[4]=a*z+d*C+k*F+p*J;b[8]=a*A+d*w+k*G+p*K;b[12]=a*B+d*D+k*H+p*e;b[1]=f*u+g*hb+y*E+h*I;b[5]=f*z+g*C+y*F+h*J;b[9]=f*A+g*w+y*G+h*K;b[13]=f*B+g*D+y*H+h*e;b[2]=m*u+n*hb+l*E+q*I;b[6]=
m*z+n*C+l*F+q*J;b[10]=m*A+n*w+l*G+q*K;b[14]=m*B+n*D+l*H+q*e;b[3]=r*u+v*hb+t*E+c*I;b[7]=r*z+v*C+t*F+c*J;b[11]=r*A+v*w+t*G+c*K;b[15]=r*B+v*D+t*H+c*e;return this};A.prototype.multiplyScalar=function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this};A.prototype.extractBasis=function(a,b,c){a.fromMatrix4Column(this,0);b.fromMatrix4Column(this,1);c.fromMatrix4Column(this,2);return this};
A.prototype.makeBasis=function(a,b,c){this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return this};A.prototype.compose=function(a,b,c){this.fromQuaternion(b);this.scale(c);this.setPosition(a);return this};A.prototype.scale=function(a){var b=this.elements,c=a.x,e=a.y;a=a.z;b[0]*=c;b[4]*=e;b[8]*=a;b[1]*=c;b[5]*=e;b[9]*=a;b[2]*=c;b[6]*=e;b[10]*=a;b[3]*=c;b[7]*=e;b[11]*=a;return this};A.prototype.setPosition=function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this};A.prototype.transpose=
function(){var a=this.elements;var b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this};A.prototype.getInverse=function(a){var b=this.elements,c=a.elements,e=b[0],d=b[1],k=b[2],p=b[3],f=b[4],g=b[5],y=b[6],h=b[7],m=b[8],n=b[9],l=b[10],q=b[11],r=b[12],t=b[13],u=b[14];b=b[15];var z=n*u*h-t*l*h+t*y*q-g*u*q-n*y*b+g*l*b,A=r*l*h-m*u*h-r*y*q+f*u*q+m*y*b-f*l*b,B=m*t*h-r*n*h+r*g*q-f*t*q-m*g*b+f*n*
b,C=r*n*y-m*t*y-r*g*l+f*t*l+m*g*u-f*n*u,w=e*z+d*A+k*B+p*C;if(0===w)return v.warn("YUKA.Matrix4: .getInverse() can not invert matrix, determinant is 0."),this.identity();w=1/w;c[0]=z*w;c[1]=(t*l*p-n*u*p-t*k*q+d*u*q+n*k*b-d*l*b)*w;c[2]=(g*u*p-t*y*p+t*k*h-d*u*h-g*k*b+d*y*b)*w;c[3]=(n*y*p-g*l*p-n*k*h+d*l*h+g*k*q-d*y*q)*w;c[4]=A*w;c[5]=(m*u*p-r*l*p+r*k*q-e*u*q-m*k*b+e*l*b)*w;c[6]=(r*y*p-f*u*p-r*k*h+e*u*h+f*k*b-e*y*b)*w;c[7]=(f*l*p-m*y*p+m*k*h-e*l*h-f*k*q+e*y*q)*w;c[8]=B*w;c[9]=(r*n*p-m*t*p-r*d*q+e*t*q+
m*d*b-e*n*b)*w;c[10]=(f*t*p-r*g*p+r*d*h-e*t*h-f*d*b+e*g*b)*w;c[11]=(m*g*p-f*n*p-m*d*h+e*n*h+f*d*q-e*g*q)*w;c[12]=C*w;c[13]=(m*t*k-r*n*k+r*d*l-e*t*l-m*d*u+e*n*u)*w;c[14]=(r*g*k-f*t*k-r*d*y+e*t*y+f*d*u-e*g*u)*w;c[15]=(f*n*k-m*g*k+m*d*y-e*n*y-f*d*l+e*g*l)*w;return a};A.prototype.getMaxScale=function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))};A.prototype.fromQuaternion=function(a){var b=this.elements,c=
a.x,e=a.y,d=a.z,k=a.w,p=c+c,f=e+e,g=d+d;a=c*p;var h=c*f;c*=g;var m=e*f;e*=g;d*=g;p*=k;f*=k;k*=g;b[0]=1-(m+d);b[4]=h-k;b[8]=c+f;b[1]=h+k;b[5]=1-(a+d);b[9]=e-p;b[2]=c-f;b[6]=e+p;b[10]=1-(a+m);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this};A.prototype.fromArray=function(a,b){b=void 0===b?0:b;for(var c=this.elements,e=0;16>e;e++)c[e]=a[e+b];return this};A.prototype.toArray=function(a,b){b=void 0===b?0:b;var c=this.elements;a[b+0]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];
a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a};A.prototype.equals=function(a){var b=this.elements;a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0};var ec=new z,ib=new g,u=function(){this.name="";this.active=!0;this.children=[];this.parent=null;this.neighbors=[];this.neighborhoodRadius=1;this.updateNeighborhood=!1;this.position=new g;this.rotation=new z;this.scale=new g(1,1,
1);this.forward=new g(0,0,1);this.up=new g(0,1,0);this.boundingRadius=0;this.maxTurnRate=Math.PI;this.matrix=new A;this.worldMatrix=new A;this.manager=null;this._cache={position:new g,rotation:new z,scale:new g};this._renderComponentCallback=this._renderComponent=null;this._started=!1;this._uuid=null};u.prototype.start=function(){};u.prototype.update=function(){};u.prototype.add=function(a){null!==a.parent&&a.parent.remove(a);this.children.push(a);a.parent=this;return this};u.prototype.remove=function(a){var b=
this.children.indexOf(a);this.children.splice(b,1);a.parent=null;return this};u.prototype.getDirection=function(a){return a.copy(this.forward).applyRotation(this.rotation).normalize()};u.prototype.lookAt=function(a){ib.subVectors(a,this.position).normalize();this.rotation.lookAt(this.forward,ib,this.up);return this};u.prototype.rotateTo=function(a,b){ib.subVectors(a,this.position).normalize();ec.lookAt(this.forward,ib,this.up);return this.rotation.rotateTo(ec,this.maxTurnRate*b)};u.prototype.updateMatrix=
function(){var a=this._cache;if(a.position.equals(this.position)&&a.rotation.equals(this.rotation)&&a.scale.equals(this.scale))return this;this.matrix.compose(this.position,this.rotation,this.scale);a.position.copy(this.position);a.rotation.copy(this.rotation);a.scale.copy(this.scale);return this};u.prototype.updateWorldMatrix=function(a,b){b=void 0===b?!1:b;var c=this.parent,e=this.children;!0===(void 0===a?!1:a)&&null!==c&&c.updateWorldMatrix(!0);this.updateMatrix();null===c?this.worldMatrix.copy(this.matrix):
this.worldMatrix.multiplyMatrices(this.parent.worldMatrix,this.matrix);if(!0===b)for(a=0,b=e.length;a<b;a++)e[a].updateWorldMatrix(!1,!0);return this};u.prototype.setRenderComponent=function(a,b){this._renderComponent=a;this._renderComponentCallback=b;return this};u.prototype.handleMessage=function(){return!1};u.prototype.sendMessage=function(a,b,c,e){null!==this.manager?this.manager.sendMessage(this,a,b,void 0===c?0:c,void 0===e?null:e):v.error("YUKA.GameEntity: The game entity must be added to a manager in order to send a message.");
return this};u.prototype.toJSON=function(){return{type:this.constructor.name,uuid:this.uuid,name:this.name,active:this.active,children:f(this.children),parent:null!==this.parent?this.parent.uuid:null,neighbors:f(this.neighbors),neighborhoodRadius:this.neighborhoodRadius,updateNeighborhood:this.updateNeighborhood,position:this.position.toArray([]),rotation:this.rotation.toArray([]),scale:this.scale.toArray([]),forward:this.forward.toArray([]),up:this.up.toArray([]),boundingRadius:this.boundingRadius,
maxTurnRate:this.maxTurnRate,matrix:this.matrix.toArray([]),worldMatrix:this.worldMatrix.toArray([]),_cache:{position:this._cache.position.toArray([]),rotation:this._cache.rotation.toArray([]),scale:this._cache.scale.toArray([])},_started:this._started}};u.prototype.fromJSON=function(a){this.uuid=a.uuid;this.name=a.name;this.active=a.active;this.neighborhoodRadius=a.neighborhoodRadius;this.updateNeighborhood=a.updateNeighborhood;this.position.fromArray(a.position);this.rotation.fromArray(a.rotation);
this.scale.fromArray(a.scale);this.forward.fromArray(a.forward);this.up.fromArray(a.up);this.boundingRadius=a.boundingRadius;this.maxTurnRate=a.maxTurnRate;this.matrix.fromArray(a.matrix);this.worldMatrix.fromArray(a.worldMatrix);this.children=a.children.slice();this.neighbors=a.neighbors.slice();this.parent=a.parent;this._cache.position.fromArray(a._cache.position);this._cache.rotation.fromArray(a._cache.rotation);this._cache.scale.fromArray(a._cache.scale);this._started=a._started;return this};
u.prototype.resolveReferences=function(a){for(var b=this.neighbors,c=0,e=b.length;c<e;c++)b[c]=a.get(b[c]);b=this.children;c=0;for(e=b.length;c<e;c++)b[c]=a.get(b[c]);this.parent=a.get(this.parent)||null;return this};$jscomp.global.Object.defineProperties(u.prototype,{uuid:{configurable:!0,enumerable:!0,get:function(){null===this._uuid&&(this._uuid=w.generateUUID());return this._uuid},set:function(a){this._uuid=a}}});var fc=new g,Ib=new g,O=function(){var a=u.call(this)||this;a.velocity=new g;a.maxSpeed=
1;a.updateOrientation=!0;return a};$jscomp.inherits(O,u);O.prototype.update=function(a){this.getSpeedSquared()>this.maxSpeed*this.maxSpeed&&(this.velocity.normalize(),this.velocity.multiplyScalar(this.maxSpeed));fc.copy(this.velocity).multiplyScalar(a);Ib.copy(this.position).add(fc);this.updateOrientation&&1e-8<this.getSpeedSquared()&&this.lookAt(Ib);this.position.copy(Ib);return this};O.prototype.getSpeed=function(){return this.velocity.length()};O.prototype.getSpeedSquared=function(){return this.velocity.squaredLength()};
O.prototype.toJSON=function(){var a=u.prototype.toJSON.call(this);a.velocity=this.velocity.toArray([]);a.maxSpeed=this.maxSpeed;a.updateOrientation=this.updateOrientation;return a};O.prototype.fromJSON=function(a){u.prototype.fromJSON.call(this,a);this.velocity.fromArray(a.velocity);this.maxSpeed=a.maxSpeed;this.updateOrientation=a.updateOrientation;return this};var q=function(){this.active=!0;this.weight=1};q.prototype.calculate=function(){};q.prototype.toJSON=function(){return{type:this.constructor.name,
active:this.active,weight:this.weight}};q.prototype.fromJSON=function(a){this.active=a.active;this.weight=a.weight;return this};q.prototype.resolveReferences=function(){};var jb=new g,kb=new g,lb=function(){return q.call(this)||this};$jscomp.inherits(lb,q);lb.prototype.calculate=function(a,b){jb.set(0,0,0);for(var c=a.neighbors,e=0,d=c.length;e<d;e++)c[e].getDirection(kb),jb.add(kb);0<c.length&&(jb.divideScalar(c.length),a.getDirection(kb),b.subVectors(jb,kb));return b};var gc=new g,Jb=new g,ea=function(a,
b){a=void 0===a?new g:a;b=void 0===b?3:b;var c=q.call(this)||this;c.target=a;c.deceleration=b;return c};$jscomp.inherits(ea,q);ea.prototype.calculate=function(a,b){var c=this.deceleration;Jb.subVectors(this.target,a.position);var e=Jb.length();0<e&&(c=Math.min(e/c,a.maxSpeed),gc.copy(Jb).multiplyScalar(c/e),b.subVectors(gc,a.velocity));return b};ea.prototype.toJSON=function(){var a=q.prototype.toJSON.call(this);a.target=this.target.toArray([]);a.deceleration=this.deceleration;return a};ea.prototype.fromJSON=
function(a){q.prototype.fromJSON.call(this,a);this.target.fromArray(a.target);this.deceleration=a.deceleration;return this};var Kb=new g,fa=function(a){a=void 0===a?new g:a;var b=q.call(this)||this;b.target=a;return b};$jscomp.inherits(fa,q);fa.prototype.calculate=function(a,b){Kb.subVectors(this.target,a.position).normalize();Kb.multiplyScalar(a.maxSpeed);return b.subVectors(Kb,a.velocity)};fa.prototype.toJSON=function(){var a=q.prototype.toJSON.call(this);a.target=this.target.toArray([]);return a};
fa.prototype.fromJSON=function(a){q.prototype.fromJSON.call(this,a);this.target.fromArray(a.target);return this};var mb=new g,nb=function(){var a=q.call(this)||this;a._seek=new fa;return a};$jscomp.inherits(nb,q);nb.prototype.calculate=function(a,b){mb.set(0,0,0);for(var c=a.neighbors,e=0,d=c.length;e<d;e++)mb.add(c[e].position);0<c.length&&(mb.divideScalar(c.length),this._seek.target=mb,this._seek.calculate(a,b),b.normalize());return b};var Ra=new g,qa=function(a,b){a=void 0===a?new g:a;b=void 0===
b?10:b;var c=q.call(this)||this;c.target=a;c.panicDistance=b;return c};$jscomp.inherits(qa,q);qa.prototype.calculate=function(a,b){var c=this.target;a.position.squaredDistanceTo(c)<=this.panicDistance*this.panicDistance&&(Ra.subVectors(a.position,c).normalize(),0===Ra.squaredLength()&&Ra.set(0,0,1),Ra.multiplyScalar(a.maxSpeed),b.subVectors(Ra,a.velocity));return b};qa.prototype.toJSON=function(){var a=q.prototype.toJSON.call(this);a.target=this.target.toArray([]);a.panicDistance=this.panicDistance;
return a};qa.prototype.fromJSON=function(a){q.prototype.fromJSON.call(this,a);this.target.fromArray(a.target);this.panicDistance=a.panicDistance;return this};var hc=new g,ic=new g,jc=new g,ra=function(a,b,c){a=void 0===a?null:a;b=void 0===b?10:b;c=void 0===c?1:c;var e=q.call(this)||this;e.pursuer=a;e.panicDistance=b;e.predictionFactor=c;e._flee=new qa;return e};$jscomp.inherits(ra,q);ra.prototype.calculate=function(a,b){var c=this.pursuer;hc.subVectors(c.position,a.position);var e=hc.length()/(a.maxSpeed+
c.getSpeed());e*=this.predictionFactor;ic.copy(c.velocity).multiplyScalar(e);jc.addVectors(c.position,ic);this._flee.target=jc;this._flee.panicDistance=this.panicDistance;this._flee.calculate(a,b);return b};ra.prototype.toJSON=function(){var a=q.prototype.toJSON.call(this);a.pursuer=this.pursuer?this.pursuer.uuid:null;a.panicDistance=this.panicDistance;a.predictionFactor=this.predictionFactor;return a};ra.prototype.fromJSON=function(a){q.prototype.fromJSON.call(this,a);this.pursuer=a.pursuer;this.panicDistance=
a.panicDistance;this.predictionFactor=a.predictionFactor;return this};ra.prototype.resolveReferences=function(a){this.pursuer=a.get(this.pursuer)||null};var ha=function(){this.loop=!1;this._waypoints=[];this._index=0};ha.prototype.add=function(a){this._waypoints.push(a);return this};ha.prototype.clear=function(){this._index=this._waypoints.length=0;return this};ha.prototype.current=function(){return this._waypoints[this._index]};ha.prototype.finished=function(){var a=this._waypoints.length-1;return!0===
this.loop?!1:this._index===a};ha.prototype.advance=function(){this._index++;this._index===this._waypoints.length&&(!0===this.loop?this._index=0:this._index--);return this};ha.prototype.toJSON=function(){for(var a={type:this.constructor.name,loop:this.loop,_waypoints:[],_index:this._index},b=this._waypoints,c=0,e=b.length;c<e;c++)a._waypoints.push(b[c].toArray([]));return a};ha.prototype.fromJSON=function(a){this.loop=a.loop;this._index=a._index;a=a._waypoints;for(var b=0,c=a.length;b<c;b++){var e=
a[b];this._waypoints.push((new g).fromArray(e))}return this};var za=function(a,b){a=void 0===a?new ha:a;b=void 0===b?1:b;var c=q.call(this)||this;c.path=a;c.nextWaypointDistance=b;c._arrive=new ea;c._seek=new fa;return c};$jscomp.inherits(za,q);za.prototype.calculate=function(a,b){var c=this.path;c.current().squaredDistanceTo(a.position)<this.nextWaypointDistance*this.nextWaypointDistance&&c.advance();var e=c.current();!0===c.finished()?(this._arrive.target=e,this._arrive.calculate(a,b)):(this._seek.target=
e,this._seek.calculate(a,b));return b};za.prototype.toJSON=function(){var a=q.prototype.toJSON.call(this);a.path=this.path.toJSON();a.nextWaypointDistance=this.nextWaypointDistance;return a};za.prototype.fromJSON=function(a){q.prototype.fromJSON.call(this,a);this.path.fromJSON(a.path);this.nextWaypointDistance=a.nextWaypointDistance;return this};var ob=new g,pb=new g,kc=new g,lc=new g,sa=function(a,b,c){a=void 0===a?null:a;b=void 0===b?null:b;c=void 0===c?3:c;var e=q.call(this)||this;e.entity1=a;
e.entity2=b;e.deceleration=c;e._arrive=new ea;return e};$jscomp.inherits(sa,q);sa.prototype.calculate=function(a,b){var c=this.entity1,e=this.entity2;ob.addVectors(c.position,e.position).multiplyScalar(.5);var d=a.position.distanceTo(ob)/a.maxSpeed;pb.copy(c.velocity).multiplyScalar(d);kc.addVectors(c.position,pb);pb.copy(e.velocity).multiplyScalar(d);lc.addVectors(e.position,pb);ob.addVectors(kc,lc).multiplyScalar(.5);this._arrive.deceleration=this.deceleration;this._arrive.target=ob;this._arrive.calculate(a,
b);return b};sa.prototype.toJSON=function(){var a=q.prototype.toJSON.call(this);a.entity1=this.entity1?this.entity1.uuid:null;a.entity2=this.entity2?this.entity2.uuid:null;a.deceleration=this.deceleration;return a};sa.prototype.fromJSON=function(a){q.prototype.fromJSON.call(this,a);this.entity1=a.entity1;this.entity2=a.entity2;this.deceleration=a.deceleration;return this};sa.prototype.resolveReferences=function(a){this.entity1=a.get(this.entity1)||null;this.entity2=a.get(this.entity2)||null};var H=
function(a,b){this.center=a=void 0===a?new g:a;this.radius=void 0===b?0:b};H.prototype.set=function(a,b){this.center=a;this.radius=b;return this};H.prototype.copy=function(a){this.center.copy(a.center);this.radius=a.radius;return this};H.prototype.clone=function(){return(new this.constructor).copy(this)};H.prototype.containsPoint=function(a){return a.squaredDistanceTo(this.center)<=this.radius*this.radius};H.prototype.intersectsBoundingSphere=function(a){var b=this.radius+a.radius;return a.center.squaredDistanceTo(this.center)<=
b*b};H.prototype.applyMatrix4=function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScale();return this};H.prototype.equals=function(a){return a.center.equals(this.center)&&a.radius===this.radius};H.prototype.toJSON=function(){return{type:this.constructor.name,center:this.center.toArray([]),radius:this.radius}};H.prototype.fromJSON=function(a){this.center.fromArray(a.center);this.radius=a.radius;return this};var ma=new g,Lb=new g,qb=new g,Mb=new g,P=function(a,b){a=void 0===a?new g:a;b=void 0===
b?new g:b;this.origin=a;this.direction=b};P.prototype.set=function(a,b){this.origin=a;this.direction=b;return this};P.prototype.copy=function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this};P.prototype.clone=function(){return(new this.constructor).copy(this)};P.prototype.at=function(a,b){return b.copy(this.direction).multiplyScalar(a).add(this.origin)};P.prototype.intersectBoundingSphere=function(a,b){ma.subVectors(a.center,this.origin);var c=ma.dot(this.direction),e=ma.dot(ma)-
c*c;a=a.radius*a.radius;if(e>a)return null;a=Math.sqrt(a-e);e=c-a;c+=a;return 0>e&&0>c?null:0>e?this.at(c,b):this.at(e,b)};P.prototype.intersectAABB=function(a,b){var c=1/this.direction.x;var e=1/this.direction.y;var d=1/this.direction.z,k=this.origin;if(0<=c){var p=(a.min.x-k.x)*c;c*=a.max.x-k.x}else p=(a.max.x-k.x)*c,c*=a.min.x-k.x;if(0<=e){var f=(a.min.y-k.y)*e;e*=a.max.y-k.y}else f=(a.max.y-k.y)*e,e*=a.min.y-k.y;if(p>e||f>c)return null;if(f>p||p!==p)p=f;if(e<c||c!==c)c=e;0<=d?(f=(a.min.z-k.z)*
d,a=(a.max.z-k.z)*d):(f=(a.max.z-k.z)*d,a=(a.min.z-k.z)*d);if(p>a||f>c)return null;if(f>p||p!==p)p=f;if(a<c||c!==c)c=a;return 0>c?null:this.at(0<=p?p:c,b)};P.prototype.intersectTriangle=function(a,b,c){var e=a.a,d=a.c;Lb.subVectors(a.b,e);qb.subVectors(d,e);Mb.crossVectors(Lb,qb);a=this.direction.dot(Mb);if(0<a){if(b)return null;b=1}else if(0>a)b=-1,a=-a;else return null;ma.subVectors(this.origin,e);e=b*this.direction.dot(qb.crossVectors(ma,qb));if(0>e)return null;d=b*this.direction.dot(Lb.cross(ma));
if(0>d||e+d>a)return null;e=-b*ma.dot(Mb);return 0>e?null:this.at(e/a,c)};P.prototype.applyMatrix4=function(a){this.origin.applyMatrix4(a);this.direction.transformDirection(a);return this};P.prototype.equals=function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)};var mc=new A,Aa=new g,rb=new g,Nb=new g,Ob=new H,Pc=new P(new g(0,0,0),new g(0,0,1)),ta=function(a){a=void 0===a?[]:a;var b=q.call(this)||this;b.obstacles=a;b.brakingWeight=.2;b.dBoxMinLength=4;return b};$jscomp.inherits(ta,
q);ta.prototype.calculate=function(a,b){var c=this.obstacles,e=null,d=Infinity,k=this.dBoxMinLength+a.getSpeed()/a.maxSpeed*this.dBoxMinLength;a.matrix.getInverse(mc);for(var p=0,f=c.length;p<f;p++){var g=c[p];if(g!==a&&(Aa.copy(g.position).applyMatrix4(mc),0<Aa.z&&Math.abs(Aa.z)<k)){var h=g.boundingRadius+a.boundingRadius;Math.abs(Aa.x)<h&&(Ob.center.copy(Aa),Ob.radius=h,Pc.intersectBoundingSphere(Ob,Nb),Nb.z<d&&(d=Nb.z,e=g,rb.copy(Aa)))}}null!==e&&(b.x=(e.boundingRadius-rb.x)*(1+(k-rb.z)/k),b.z=
(e.boundingRadius-rb.z)*this.brakingWeight,b.applyRotation(a.rotation));return b};ta.prototype.toJSON=function(){var a=q.prototype.toJSON.call(this);a.obstacles=[];a.brakingWeight=this.brakingWeight;a.dBoxMinLength=this.dBoxMinLength;for(var b=0,c=this.obstacles.length;b<c;b++)a.obstacles.push(this.obstacles[b].uuid);return a};ta.prototype.fromJSON=function(a){q.prototype.fromJSON.call(this,a);this.obstacles=a.obstacles;this.brakingWeight=a.brakingWeight;this.dBoxMinLength=a.dBoxMinLength;return this};
ta.prototype.resolveReferences=function(a){for(var b=this.obstacles,c=0,e=b.length;c<e;c++)b[c]=a.get(b[c])};var Pb=new g,nc=new g,oc=new g,pc=new g,ua=function(a,b){a=void 0===a?null:a;b=void 0===b?new g:b;var c=q.call(this)||this;c.leader=a;c.offset=b;c._arrive=new ea;c._arrive.deceleration=1.5;return c};$jscomp.inherits(ua,q);ua.prototype.calculate=function(a,b){var c=this.leader;Pb.copy(this.offset).applyMatrix4(c.matrix);nc.subVectors(Pb,a.position);var e=nc.length()/(a.maxSpeed+c.getSpeed());
oc.copy(c.velocity).multiplyScalar(e);pc.addVectors(Pb,oc);this._arrive.target=pc;this._arrive.calculate(a,b);return b};ua.prototype.toJSON=function(){var a=q.prototype.toJSON.call(this);a.leader=this.leader?this.leader.uuid:null;a.offset=this.offset;return a};ua.prototype.fromJSON=function(a){q.prototype.fromJSON.call(this,a);this.leader=a.leader;this.offset=a.offset;return this};ua.prototype.resolveReferences=function(a){this.leader=a.get(this.leader)||null};var Qb=new g,Rb=new g,qc=new g,rc=new g,
sc=new g,va=function(a,b){a=void 0===a?null:a;b=void 0===b?1:b;var c=q.call(this)||this;c.evader=a;c.predictionFactor=b;c._seek=new fa;return c};$jscomp.inherits(va,q);va.prototype.calculate=function(a,b){var c=this.evader;Qb.subVectors(c.position,a.position);a.getDirection(Rb);c.getDirection(qc);var e=0<Qb.dot(Rb),d=-.95>Rb.dot(qc);if(!0===e&&!0===d)return this._seek.target=c.position,this._seek.calculate(a,b),b;e=Qb.length()/(a.maxSpeed+c.getSpeed());e*=this.predictionFactor;rc.copy(c.velocity).multiplyScalar(e);
sc.addVectors(c.position,rc);this._seek.target=sc;this._seek.calculate(a,b);return b};va.prototype.toJSON=function(){var a=q.prototype.toJSON.call(this);a.evader=this.evader?this.evader.uuid:null;a.predictionFactor=this.predictionFactor;return a};va.prototype.fromJSON=function(a){q.prototype.fromJSON.call(this,a);this.evader=a.evader;this.predictionFactor=a.predictionFactor;return this};va.prototype.resolveReferences=function(a){this.evader=a.get(this.evader)||null};var sb=new g,tb=function(){return q.call(this)||
this};$jscomp.inherits(tb,q);tb.prototype.calculate=function(a,b){for(var c=a.neighbors,e=0,d=c.length;e<d;e++){sb.subVectors(a.position,c[e].position);var k=sb.length();0===k&&(k=.0001);sb.normalize().divideScalar(k);b.add(sb)}return b};var Sa=new g,Sb=new g,Ba=function(a,b,c){a=void 0===a?1:a;b=void 0===b?5:b;c=void 0===c?5:c;var e=q.call(this)||this;e.radius=a;e.distance=b;e.jitter=c;e._targetLocal=new g;a=e.radius;b=e._targetLocal;c=Math.random()*Math.PI*2;b.x=a*Math.cos(c);b.z=a*Math.sin(c);
return e};$jscomp.inherits(Ba,q);Ba.prototype.calculate=function(a,b,c){c*=this.jitter;Sb.x=w.randFloat(-1,1)*c;Sb.z=w.randFloat(-1,1)*c;this._targetLocal.add(Sb);this._targetLocal.normalize();this._targetLocal.multiplyScalar(this.radius);Sa.copy(this._targetLocal);Sa.z+=this.distance;Sa.applyMatrix4(a.worldMatrix);b.subVectors(Sa,a.position);return b};Ba.prototype.toJSON=function(){var a=q.prototype.toJSON.call(this);a.radius=this.radius;a.distance=this.distance;a.jitter=this.jitter;a._targetLocal=
this._targetLocal.toArray([]);return a};Ba.prototype.fromJSON=function(a){q.prototype.fromJSON.call(this,a);this.radius=a.radius;this.distance=a.distance;this.jitter=a.jitter;this._targetLocal.fromArray(a._targetLocal);return this};var ub=new g,Q=function(a){this.vehicle=a;this.behaviors=[];this._steeringForce=new g;this._typesMap=new Map};Q.prototype.add=function(a){this.behaviors.push(a);return this};Q.prototype.remove=function(a){a=this.behaviors.indexOf(a);this.behaviors.splice(a,1);return this};
Q.prototype.clear=function(){this.behaviors.length=0;return this};Q.prototype.calculate=function(a,b){this._calculateByOrder(a);return b.copy(this._steeringForce)};Q.prototype._accumulate=function(a){var b=this._steeringForce.length();b=this.vehicle.maxForce-b;if(0>=b)return!1;a.length()>b&&a.normalize().multiplyScalar(b);this._steeringForce.add(a);return!0};Q.prototype._calculateByOrder=function(a){var b=this.behaviors;this._steeringForce.set(0,0,0);for(var c=0,e=b.length;c<e;c++){var d=b[c];if(!0===
d.active&&(ub.set(0,0,0),d.calculate(this.vehicle,ub,a),ub.multiplyScalar(d.weight),!1===this._accumulate(ub)))break}};Q.prototype.toJSON=function(){for(var a={type:"SteeringManager",behaviors:[]},b=this.behaviors,c=0,e=b.length;c<e;c++)a.behaviors.push(b[c].toJSON());return a};Q.prototype.fromJSON=function(a){this.clear();a=a.behaviors;for(var b=0,c=a.length;b<c;b++){var e=a[b],d=e.type;switch(d){case "SteeringBehavior":e=(new q).fromJSON(e);break;case "AlignmentBehavior":e=(new lb).fromJSON(e);
break;case "ArriveBehavior":e=(new ea).fromJSON(e);break;case "CohesionBehavior":e=(new nb).fromJSON(e);break;case "EvadeBehavior":e=(new ra).fromJSON(e);break;case "FleeBehavior":e=(new qa).fromJSON(e);break;case "FollowPathBehavior":e=(new za).fromJSON(e);break;case "InterposeBehavior":e=(new sa).fromJSON(e);break;case "ObstacleAvoidanceBehavior":e=(new ta).fromJSON(e);break;case "OffsetPursuitBehavior":e=(new ua).fromJSON(e);break;case "PursuitBehavior":e=(new va).fromJSON(e);break;case "SeekBehavior":e=
(new fa).fromJSON(e);break;case "SeparationBehavior":e=(new tb).fromJSON(e);break;case "WanderBehavior":e=(new Ba).fromJSON(e);break;default:var k=this._typesMap.get(d);if(void 0!==k)e=(new k).fromJSON(e);else{v.warn("YUKA.SteeringManager: Unsupported steering behavior type:",d);continue}}this.add(e)}return this};Q.prototype.registerType=function(a,b){this._typesMap.set(a,b);return this};Q.prototype.resolveReferences=function(a){for(var b=this.behaviors,c=0,e=b.length;c<e;c++)b[c].resolveReferences(a);
return this};var Ta=function(a){this.count=void 0===a?10:a;this._history=[];for(a=this._slot=0;a<this.count;a++)this._history[a]=new g};Ta.prototype.calculate=function(a,b){b.set(0,0,0);this._slot===this.count&&(this._slot=0);this._history[this._slot].copy(a);this._slot++;for(a=0;a<this.count;a++)b.add(this._history[a]);b.divideScalar(this.count);return b};Ta.prototype.toJSON=function(){for(var a={type:this.constructor.name,count:this.count,_history:[],_slot:this._slot},b=this._history,c=0,e=b.length;c<
e;c++)a._history.push(b[c].toArray([]));return a};Ta.prototype.fromJSON=function(a){this.count=a.count;this._slot=a._slot;a=a._history;for(var b=this._history.length=0,c=a.length;b<c;b++){var e=a[b];this._history.push((new g).fromArray(e))}return this};var tc=new g,vb=new g,uc=new g,Ua=new g,vc=new g,wa=function(){var a=O.call(this)||this;a.mass=1;a.maxForce=100;a.steering=new Q(a);a.smoother=null;return a};$jscomp.inherits(wa,O);wa.prototype.update=function(a){this.steering.calculate(a,tc);uc.copy(tc).divideScalar(this.mass);
this.velocity.add(uc.multiplyScalar(a));this.getSpeedSquared()>this.maxSpeed*this.maxSpeed&&(this.velocity.normalize(),this.velocity.multiplyScalar(this.maxSpeed));vb.copy(this.velocity).multiplyScalar(a);Ua.copy(this.position).add(vb);!0===this.updateOrientation&&null===this.smoother&&1e-8<this.getSpeedSquared()&&this.lookAt(Ua);this.position.copy(Ua);!0===this.updateOrientation&&null!==this.smoother&&(this.smoother.calculate(this.velocity,vc),vb.copy(vc).multiplyScalar(a),Ua.copy(this.position).add(vb),
this.lookAt(Ua));return this};wa.prototype.toJSON=function(){var a=O.prototype.toJSON.call(this);a.mass=this.mass;a.maxForce=this.maxForce;a.steering=this.steering.toJSON();a.smoother=this.smoother?this.smoother.toJSON():null;return a};wa.prototype.fromJSON=function(a){O.prototype.fromJSON.call(this,a);this.mass=a.mass;this.maxForce=a.maxForce;this.steering=(new Q(this)).fromJSON(a.steering);this.smoother=a.smoother?(new Ta).fromJSON(a.smoother):null;return this};wa.prototype.resolveReferences=function(a){O.prototype.resolveReferences.call(this,
a);this.steering.resolveReferences(a)};var S=function(){};S.prototype.touching=function(){return!1};S.prototype.toJSON=function(){return{type:this.constructor.name}};S.prototype.fromJSON=function(){return this};var Va=new g,ia=[new g,new g,new g,new g,new g,new g,new g,new g],C=function(a,b){a=void 0===a?new g:a;b=void 0===b?new g:b;this.min=a;this.max=b};C.prototype.set=function(a,b){this.min=a;this.max=b;return this};C.prototype.copy=function(a){this.min.copy(a.min);this.max.copy(a.max);return this};
C.prototype.clone=function(){return(new this.constructor).copy(this)};C.prototype.clampPoint=function(a,b){b.copy(a).clamp(this.min,this.max);return b};C.prototype.containsPoint=function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0};C.prototype.expand=function(a){this.min.min(a);this.max.max(a);return this};C.prototype.getCenter=function(a){return a.addVectors(this.min,this.max).multiplyScalar(.5)};C.prototype.intersectsAABB=function(a){return a.max.x<
this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0};C.prototype.intersectsBoundingSphere=function(a){this.clampPoint(a.center,Va);return Va.squaredDistanceTo(a.center)<=a.radius*a.radius};C.prototype.fromCenterAndSize=function(a,b){Va.copy(b).multiplyScalar(.5);this.min.copy(a).sub(Va);this.max.copy(a).add(Va);return this};C.prototype.fromPoints=function(a){this.min.set(Infinity,Infinity,Infinity);this.max.set(-Infinity,-Infinity,-Infinity);
for(var b=0,c=a.length;b<c;b++)this.expand(a[b]);return this};C.prototype.applyMatrix4=function(a){var b=this.min,c=this.max;ia[0].set(b.x,b.y,b.z).applyMatrix4(a);ia[1].set(b.x,b.y,c.z).applyMatrix4(a);ia[2].set(b.x,c.y,b.z).applyMatrix4(a);ia[3].set(b.x,c.y,c.z).applyMatrix4(a);ia[4].set(c.x,b.y,b.z).applyMatrix4(a);ia[5].set(c.x,b.y,c.z).applyMatrix4(a);ia[6].set(c.x,c.y,b.z).applyMatrix4(a);ia[7].set(c.x,c.y,c.z).applyMatrix4(a);return this.fromPoints(ia)};C.prototype.equals=function(a){return a.min.equals(this.min)&&
a.max.equals(this.max)};C.prototype.toJSON=function(){return{type:this.constructor.name,min:this.min.toArray([]),max:this.max.toArray([])}};C.prototype.fromJSON=function(a){this.min.fromArray(a.min);this.max.fromArray(a.max);return this};var wc=new H,na=function(a,b){a=void 0===a?new g:a;b=void 0===b?new g:b;this._aabb=new C(a,b);return this};$jscomp.inherits(na,S);na.prototype.fromPositionAndSize=function(a,b){this._aabb.fromCenterAndSize(a,b);return this};na.prototype.touching=function(a){wc.set(a.position,
a.boundingRadius);return this._aabb.intersectsBoundingSphere(wc)};na.prototype.toJSON=function(){var a=S.prototype.toJSON.call(this);a._aabb=this._aabb.toJSON();return a};na.prototype.fromJSON=function(a){S.prototype.fromJSON.call(this,a);this._aabb.fromJSON(a._aabb);return this};$jscomp.global.Object.defineProperties(na.prototype,{min:{configurable:!0,enumerable:!0,get:function(){return this._aabb.min},set:function(a){this._aabb.min=a}},max:{configurable:!0,enumerable:!0,get:function(){return this._aabb.max},
set:function(a){this._aabb.max=a}}});var xc=new H,xa=function(a,b){a=void 0===a?new g:a;this._boundingSphere=new H(a,void 0===b?0:b);return this};$jscomp.inherits(xa,S);xa.prototype.touching=function(a){xc.set(a.position,a.boundingRadius);return this._boundingSphere.intersectsBoundingSphere(xc)};xa.prototype.toJSON=function(){var a=S.prototype.toJSON.call(this);a._boundingSphere=this._boundingSphere.toJSON();return a};xa.prototype.fromJSON=function(a){S.prototype.fromJSON.call(this,a);this._boundingSphere.fromJSON(a._boundingSphere);
return this};$jscomp.global.Object.defineProperties(xa.prototype,{position:{configurable:!0,enumerable:!0,get:function(){return this._boundingSphere.center},set:function(a){this._boundingSphere.center=a}},radius:{configurable:!0,enumerable:!0,get:function(){return this._boundingSphere.radius},set:function(a){this._boundingSphere.radius=a}}});var oa=function(a){a=void 0===a?new S:a;this.active=!0;this.region=a;this._typesMap=new Map};oa.prototype.check=function(a){!0===this.active&&!0===this.region.touching(a)&&
this.execute(a);return this};oa.prototype.execute=function(){};oa.prototype.update=function(){};oa.prototype.toJSON=function(){return{type:this.constructor.name,active:this.active,region:this.region.toJSON()}};oa.prototype.fromJSON=function(a){this.active=a.active;a=a.region;var b=a.type;switch(b){case "TriggerRegion":this.region=(new S).fromJSON(a);break;case "RectangularTriggerRegion":this.region=(new na).fromJSON(a);break;case "SphericalTriggerRegion":this.region=(new xa).fromJSON(a);break;default:b=
this._typesMap.get(b),void 0!==b?this.region=(new b).fromJSON(a):v.warn("YUKA.Trigger: Unsupported trigger region type:",a.type)}return this};oa.prototype.registerType=function(a,b){this._typesMap.set(a,b);return this};var Ca=[],K=function(){this.entities=[];this.triggers=[];this.spatialIndex=null;this._indexMap=new Map;this._typesMap=new Map;this._messageDispatcher=new X};K.prototype.add=function(a){this.entities.push(a);a.manager=this;return this};K.prototype.remove=function(a){var b=this.entities.indexOf(a);
this.entities.splice(b,1);a.manager=null;return this};K.prototype.addTrigger=function(a){this.triggers.push(a);return this};K.prototype.removeTrigger=function(a){a=this.triggers.indexOf(a);this.triggers.splice(a,1);return this};K.prototype.clear=function(){this.entities.length=0;this.triggers.length=0;this._messageDispatcher.clear();return this};K.prototype.getEntityByName=function(a){for(var b=this.entities,c=0,e=b.length;c<e;c++){var d=b[c];if(d.name===a)return d}return null};K.prototype.update=
function(a){for(var b=this.entities,c=this.triggers,e=b.length-1;0<=e;e--)this.updateEntity(b[e],a);for(b=c.length-1;0<=b;b--)this.updateTrigger(c[b],a);this._messageDispatcher.dispatchDelayedMessages(a);return this};K.prototype.updateEntity=function(a,b){if(!0===a.active){this.updateNeighborhood(a);!1===a._started&&(a.start(),a._started=!0);a.update(b);a.updateWorldMatrix();for(var c=a.children,e=c.length-1;0<=e;e--)this.updateEntity(c[e],b);null!==this.spatialIndex&&(b=this._indexMap.get(a)||-1,
b=this.spatialIndex.updateEntity(a,b),this._indexMap.set(a,b));b=a._renderComponent;c=a._renderComponentCallback;null!==b&&null!==c&&c(a,b)}return this};K.prototype.updateNeighborhood=function(a){if(!0===a.updateNeighborhood){a.neighbors.length=0;null!==this.spatialIndex?this.spatialIndex.query(a.position,a.neighborhoodRadius,Ca):(Ca.length=0,Ca.push.apply(Ca,$jscomp.arrayFromIterable(this.entities)));for(var b=a.neighborhoodRadius*a.neighborhoodRadius,c=0,e=Ca.length;c<e;c++){var d=Ca[c];a!==d&&
!0===d.active&&a.position.squaredDistanceTo(d.position)<=b&&a.neighbors.push(d)}}return this};K.prototype.updateTrigger=function(a,b){if(!0===a.active){a.update(b);b=this.entities;for(var c=b.length-1;0<=c;c--){var e=b[c];!0===e.active&&a.check(e)}}return this};K.prototype.sendMessage=function(a,b,c,e,d){this._messageDispatcher.dispatch(a,b,c,e,d);return this};K.prototype.toJSON=function(){function a(c){b.entities.push(c.toJSON());for(var e=0,d=c.children.length;e<d;e++)a(c.children[e])}for(var b=
{type:this.constructor.name,entities:[],triggers:[],_messageDispatcher:this._messageDispatcher.toJSON()},c=0,e=this.entities.length;c<e;c++)a(this.entities[c]);c=0;for(e=this.triggers.length;c<e;c++)b.triggers.push(this.triggers[c].toJSON());return b};K.prototype.fromJSON=function(a){this.clear();var b=a.entities,c=a.triggers;a=a._messageDispatcher;for(var e=new Map,d=0,k=b.length;d<k;d++){var f=b[d],g=f.type;switch(g){case "GameEntity":f=(new u).fromJSON(f);break;case "MovingEntity":f=(new O).fromJSON(f);
break;case "Vehicle":f=(new wa).fromJSON(f);break;default:var h=this._typesMap.get(g);if(void 0!==h)f=(new h).fromJSON(f);else{v.warn("YUKA.EntityManager: Unsupported entity type:",g);continue}}e.set(f.uuid,f);null===f.parent&&this.add(f)}k=$jscomp.makeIterator(e.values());for(b=k.next();!b.done;b=k.next())b.value.resolveReferences(e);e=0;for(k=c.length;e<k;e++){b=c[e];d=b.type;if("Trigger"===d)b=(new oa).fromJSON(b);else if(f=this._typesMap.get(d),void 0!==f)b=(new f).fromJSON(b);else{v.warn("YUKA.EntityManager: Unsupported trigger type:",
d);continue}this.addTrigger(b)}this._messageDispatcher.fromJSON(a);return this};K.prototype.registerType=function(a,b){this._typesMap.set(a,b);return this};var Wa=function(){this._events=new Map};Wa.prototype.addEventListener=function(a,b){var c=this._events;!1===c.has(a)&&c.set(a,[]);a=c.get(a);-1===a.indexOf(b)&&a.push(b)};Wa.prototype.removeEventListener=function(a,b){a=this._events.get(a);void 0!==a&&(b=a.indexOf(b),-1!==b&&a.splice(b,1))};Wa.prototype.hasEventListener=function(a,b){a=this._events.get(a);
return void 0!==a&&-1!==a.indexOf(b)};Wa.prototype.dispatchEvent=function(a){var b=this._events.get(a.type);if(void 0!==b){a.target=this;for(var c=0,e=b.length;c<e;c++)b[c].call(this,a)}};var Xa=function(a,b){this.vertices=a=void 0===a?new Float32Array:a;this.indices=void 0===b?null:b;this.backfaceCulling=!0;this.aabb=new C;this.boundingSphere=new H;this.computeBoundingVolume()};Xa.prototype.computeBoundingVolume=function(){var a=this.vertices,b=new g,c=this.aabb,e=this.boundingSphere;c.min.set(Infinity,
Infinity,Infinity);c.max.set(-Infinity,-Infinity,-Infinity);for(var d=0,k=a.length;d<k;d+=3)b.x=a[d],b.y=a[d+1],b.z=a[d+2],c.expand(b);c.getCenter(e.center);e.radius=e.center.distanceTo(c.max);return this};Xa.prototype.toJSON=function(){var a={type:this.constructor.name};a.indices={type:this.indices?this.indices.constructor.name:null,data:this.indices?Array.from(this.indices):null};a.vertices=Array.from(this.vertices);a.backfaceCulling=this.backfaceCulling;a.aabb=this.aabb.toJSON();a.boundingSphere=
this.boundingSphere.toJSON();return a};Xa.prototype.fromJSON=function(a){this.aabb=(new C).fromJSON(a.aabb);this.boundingSphere=(new H).fromJSON(a.boundingSphere);this.backfaceCulling=a.backfaceCulling;this.vertices=new Float32Array(a.vertices);switch(a.indices.type){case "Uint16Array":this.indices=new Uint16Array(a.indices.data);break;case "Uint32Array":this.indices=new Uint32Array(a.indices.data);break;case "null":this.indices=null}return this};var Da=function(){this.currentTime=this.previousTime=
this.startTime=0;this.detectPageVisibility=!0;"undefined"!==typeof document&&void 0!==document.hidden&&(this._pageVisibilityHandler=h.bind(this),document.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))};Da.prototype.getDelta=function(){return(this.currentTime-this.previousTime)/1E3};Da.prototype.getElapsed=function(){return(this.currentTime-this.startTime)/1E3};Da.prototype.update=function(){this.previousTime=this.currentTime;this.currentTime=this.now();return this};Da.prototype.now=
function(){return("undefined"===typeof performance?Date:performance).now()};var yc=function(a){this.updateFrequency=void 0===a?0:a;this._time=new Da;this._nextUpdateTime=0};yc.prototype.ready=function(){this._time.update();return this._time.currentTime>=this._nextUpdateTime?(this._nextUpdateTime=this._time.currentTime+1E3/this.updateFrequency,!0):!1};var ja=function(){};ja.prototype.enter=function(){};ja.prototype.execute=function(){};ja.prototype.exit=function(){};ja.prototype.toJSON=function(){};
ja.prototype.fromJSON=function(){};ja.prototype.resolveReferences=function(){};ja.prototype.onMessage=function(){return!1};var L=function(a){this.owner=void 0===a?null:a;this.globalState=this.previousState=this.currentState=null;this.states=new Map;this._typesMap=new Map};L.prototype.update=function(){null!==this.globalState&&this.globalState.execute(this.owner);null!==this.currentState&&this.currentState.execute(this.owner);return this};L.prototype.add=function(a,b){b instanceof ja?this.states.set(a,
b):v.warn('YUKA.StateMachine: .add() needs a parameter of type "YUKA.State".');return this};L.prototype.remove=function(a){this.states.delete(a);return this};L.prototype.get=function(a){return this.states.get(a)};L.prototype.changeTo=function(a){a=this.get(a);this._change(a);return this};L.prototype.revert=function(){this._change(this.previousState);return this};L.prototype.in=function(a){return this.get(a)===this.currentState};L.prototype.handleMessage=function(a){return null!==this.currentState&&
!0===this.currentState.onMessage(this.owner,a)||null!==this.globalState&&!0===this.globalState.onMessage(this.owner,a)?!0:!1};L.prototype.toJSON=function(){for(var a={owner:this.owner.uuid,currentState:null,previousState:null,globalState:null,states:[]},b=new Map,c=$jscomp.makeIterator(this.states),e=c.next();!e.done;e=c.next()){var d=$jscomp.makeIterator(e.value);e=d.next().value;d=d.next().value;a.states.push({type:d.constructor.name,id:e,state:d.toJSON()});b.set(d,e)}a.currentState=b.get(this.currentState)||
null;a.previousState=b.get(this.previousState)||null;a.globalState=b.get(this.globalState)||null;return a};L.prototype.fromJSON=function(a){this.owner=a.owner;for(var b=a.states,c=0,e=b.length;c<e;c++){var d=b[c],k=d.type,f=this._typesMap.get(k);void 0!==f?(k=d.id,d=(new f).fromJSON(d.state),this.add(k,d)):v.warn("YUKA.StateMachine: Unsupported state type:",k)}this.currentState=null!==a.currentState?this.get(a.currentState)||null:null;this.previousState=null!==a.previousState?this.get(a.previousState)||
null:null;this.globalState=null!==a.globalState?this.get(a.globalState)||null:null;return this};L.prototype.resolveReferences=function(a){this.owner=a.get(this.owner)||null;for(var b=$jscomp.makeIterator(this.states.values()),c=b.next();!c.done;c=b.next())c.value.resolveReferences(a);return this};L.prototype.registerType=function(a,b){this._typesMap.set(a,b);return this};L.prototype._change=function(a){this.previousState=this.currentState;this.currentState.exit(this.owner);this.currentState=a;this.currentState.enter(this.owner)};
var ka=function(){};ka.prototype.clearDegreeOfMembership=function(){};ka.prototype.getDegreeOfMembership=function(){};ka.prototype.updateDegreeOfMembership=function(){};ka.prototype.toJSON=function(){return{type:this.constructor.name}};var I=function(a){this.terms=a=void 0===a?[]:a;return this};$jscomp.inherits(I,ka);I.prototype.clearDegreeOfMembership=function(){for(var a=this.terms,b=0,c=a.length;b<c;b++)a[b].clearDegreeOfMembership();return this};I.prototype.updateDegreeOfMembership=function(a){for(var b=
this.terms,c=0,e=b.length;c<e;c++)b[c].updateDegreeOfMembership(a);return this};I.prototype.toJSON=function(){var a=ka.prototype.toJSON.call(this);a.terms=[];for(var b=0,c=this.terms.length;b<c;b++){var e=this.terms[b];e instanceof I?a.terms.push(e.toJSON()):a.terms.push(e.uuid)}return a};var wb=function(){var a=Array.from(arguments);return I.call(this,a)||this};$jscomp.inherits(wb,I);wb.prototype.getDegreeOfMembership=function(){for(var a=this.terms,b=Infinity,c=0,e=a.length;c<e;c++){var d=a[c].getDegreeOfMembership();
d<b&&(b=d)}return b};var Ea=function(a){a=void 0===a?null:a;return I.call(this,null!==a?[a]:[])||this};$jscomp.inherits(Ea,I);Ea.prototype.clearDegreeOfMembership=function(){this.terms[0].clearDegreeOfMembership();return this};Ea.prototype.getDegreeOfMembership=function(){var a=this.terms[0].getDegreeOfMembership();return Math.sqrt(a)};Ea.prototype.updateDegreeOfMembership=function(a){this.terms[0].updateDegreeOfMembership(Math.sqrt(a));return this};var xb=function(){var a=Array.from(arguments);return I.call(this,
a)||this};$jscomp.inherits(xb,I);xb.prototype.getDegreeOfMembership=function(){for(var a=this.terms,b=-Infinity,c=0,e=a.length;c<e;c++){var d=a[c].getDegreeOfMembership();d>b&&(b=d)}return b};var Fa=function(a){a=void 0===a?null:a;return I.call(this,null!==a?[a]:[])||this};$jscomp.inherits(Fa,I);Fa.prototype.clearDegreeOfMembership=function(){this.terms[0].clearDegreeOfMembership();return this};Fa.prototype.getDegreeOfMembership=function(){var a=this.terms[0].getDegreeOfMembership();return a*a};Fa.prototype.updateDegreeOfMembership=
function(a){this.terms[0].updateDegreeOfMembership(a*a);return this};var B=function(a){this.degreeOfMembership=0;this.representativeValue=void 0===a?0:a;this.right=this.left=0;this._uuid=null;return this};$jscomp.inherits(B,ka);B.prototype.computeDegreeOfMembership=function(){};B.prototype.clearDegreeOfMembership=function(){this.degreeOfMembership=0;return this};B.prototype.getDegreeOfMembership=function(){return this.degreeOfMembership};B.prototype.updateDegreeOfMembership=function(a){a>this.degreeOfMembership&&
(this.degreeOfMembership=a);return this};B.prototype.toJSON=function(){var a=ka.prototype.toJSON.call(this);a.degreeOfMembership=this.degreeOfMembership;a.representativeValue=this.representativeValue;a.left=this.left;a.right=this.right;a.uuid=this.uuid;return a};B.prototype.fromJSON=function(a){this.degreeOfMembership=a.degreeOfMembership;this.representativeValue=a.representativeValue;this.left=a.left;this.right=a.right;this.uuid=a.uuid;return this};$jscomp.global.Object.defineProperties(B.prototype,
{uuid:{configurable:!0,enumerable:!0,get:function(){null===this._uuid&&(this._uuid=w.generateUUID());return this._uuid},set:function(a){this._uuid=a}}});var Ga=function(a,b,c){a=void 0===a?0:a;b=void 0===b?0:b;c=void 0===c?0:c;var e=B.call(this,(b+a)/2)||this;e.left=a;e.midpoint=b;e.right=c;return e};$jscomp.inherits(Ga,B);Ga.prototype.computeDegreeOfMembership=function(a){var b=this.midpoint,c=this.right;return a>=this.left&&a<=b?1:a>b&&a<=c?1/(c-b)*(c-a):0};Ga.prototype.toJSON=function(){var a=
B.prototype.toJSON.call(this);a.midpoint=this.midpoint;return a};Ga.prototype.fromJSON=function(a){B.prototype.fromJSON.call(this,a);this.midpoint=a.midpoint;return this};var Ha=function(a,b,c){a=void 0===a?0:a;b=void 0===b?0:b;c=void 0===c?0:c;var e=B.call(this,(b+c)/2)||this;e.left=a;e.midpoint=b;e.right=c;return e};$jscomp.inherits(Ha,B);Ha.prototype.computeDegreeOfMembership=function(a){var b=this.midpoint,c=this.left,e=this.right;return a>=c&&a<=b?1/(b-c)*(a-c):a>b&&a<=e?1:0};Ha.prototype.toJSON=
function(){var a=B.prototype.toJSON.call(this);a.midpoint=this.midpoint;return a};Ha.prototype.fromJSON=function(a){B.prototype.fromJSON.call(this,a);this.midpoint=a.midpoint;return this};var Ia=function(a,b,c){a=void 0===a?0:a;b=void 0===b?0:b;c=void 0===c?0:c;var e=B.call(this,b)||this;e.left=a;e.midpoint=b;e.right=c;return e};$jscomp.inherits(Ia,B);Ia.prototype.computeDegreeOfMembership=function(a){var b=this.right;return a>=this.left&&a<=b?1:0};Ia.prototype.toJSON=function(){var a=B.prototype.toJSON.call(this);
a.midpoint=this.midpoint;return a};Ia.prototype.fromJSON=function(a){B.prototype.fromJSON.call(this,a);this.midpoint=a.midpoint;return this};var Ja=function(a,b,c){a=void 0===a?0:a;b=void 0===b?0:b;c=void 0===c?0:c;var e=B.call(this,b)||this;e.left=a;e.midpoint=b;e.right=c;return e};$jscomp.inherits(Ja,B);Ja.prototype.computeDegreeOfMembership=function(a){var b=this.midpoint,c=this.left,e=this.right;return a>=c&&a<=b?1/(b-c)*(a-c):a>b&&a<=e?1/(e-b)*(e-a):0};Ja.prototype.toJSON=function(){var a=B.prototype.toJSON.call(this);
a.midpoint=this.midpoint;return a};Ja.prototype.fromJSON=function(a){B.prototype.fromJSON.call(this,a);this.midpoint=a.midpoint;return this};var Ka=function(a,b){this.antecedent=void 0===a?null:a;this.consequence=void 0===b?null:b};Ka.prototype.initConsequence=function(){this.consequence.clearDegreeOfMembership();return this};Ka.prototype.evaluate=function(){this.consequence.updateDegreeOfMembership(this.antecedent.getDegreeOfMembership());return this};Ka.prototype.toJSON=function(){var a={},b=this.antecedent,
c=this.consequence;a.type=this.constructor.name;a.antecedent=b instanceof I?b.toJSON():b.uuid;a.consequence=c instanceof I?c.toJSON():c.uuid;return a};Ka.prototype.fromJSON=function(a,b){function c(a){if("string"===typeof a)return b.get(a)||null;var e=a.type;switch(e){case "FuzzyAND":e=new wb;break;case "FuzzyOR":e=new xb;break;case "FuzzyVERY":e=new Fa;break;case "FuzzyFAIRLY":e=new Ea;break;default:v.error("YUKA.FuzzyRule: Unsupported operator type:",e);return}a=a.terms;for(var d=0,f=a.length;d<
f;d++)e.terms.push(c(a[d]));return e}this.antecedent=c(a.antecedent);this.consequence=c(a.consequence);return this};var la=function(){this.fuzzySets=[];this.minRange=Infinity;this.maxRange=-Infinity};la.prototype.add=function(a){this.fuzzySets.push(a);a.left<this.minRange&&(this.minRange=a.left);a.right>this.maxRange&&(this.maxRange=a.right);return this};la.prototype.remove=function(a){var b=this.fuzzySets;a=b.indexOf(a);b.splice(a,1);this.minRange=Infinity;this.maxRange=-Infinity;a=0;for(var c=b.length;a<
c;a++){var e=b[a];e.left<this.minRange&&(this.minRange=e.left);e.right>this.maxRange&&(this.maxRange=e.right)}return this};la.prototype.fuzzify=function(a){if(a<this.minRange||a>this.maxRange)v.warn("YUKA.FuzzyVariable: Value for fuzzification out of range.");else{for(var b=this.fuzzySets,c=0,e=b.length;c<e;c++){var d=b[c];d.degreeOfMembership=d.computeDegreeOfMembership(a)}return this}};la.prototype.defuzzifyMaxAv=function(){for(var a=this.fuzzySets,b=0,c=0,e=0,d=a.length;e<d;e++){var k=a[e];b+=
k.degreeOfMembership;c+=k.representativeValue*k.degreeOfMembership}return 0===b?0:c/b};la.prototype.defuzzifyCentroid=function(a){a=void 0===a?10:a;for(var b=this.fuzzySets,c=(this.maxRange-this.minRange)/a,e=0,d=0,k=1;k<=a;k++)for(var f=this.minRange+k*c,g=0,h=b.length;g<h;g++){var m=b[g];m=Math.min(m.degreeOfMembership,m.computeDegreeOfMembership(f));e+=m;d+=f*m}return 0===e?0:d/e};la.prototype.toJSON=function(){for(var a={type:this.constructor.name,fuzzySets:[],minRange:this.minRange.toString(),
maxRange:this.maxRange.toString()},b=0,c=this.fuzzySets.length;b<c;b++)a.fuzzySets.push(this.fuzzySets[b].toJSON());return a};la.prototype.fromJSON=function(a){this.minRange=parseFloat(a.minRange);this.maxRange=parseFloat(a.maxRange);for(var b=0,c=a.fuzzySets.length;b<c;b++){var e=a.fuzzySets[b];switch(e.type){case "LeftShoulderFuzzySet":this.fuzzySets.push((new Ga).fromJSON(e));break;case "RightShoulderFuzzySet":this.fuzzySets.push((new Ha).fromJSON(e));break;case "SingletonFuzzySet":this.fuzzySets.push((new Ia).fromJSON(e));
break;case "TriangularFuzzySet":this.fuzzySets.push((new Ja).fromJSON(e));break;default:v.error("YUKA.FuzzyVariable: Unsupported fuzzy set type:",e.type)}}return this};var M=function(){this.rules=[];this.flvs=new Map};M.prototype.addFLV=function(a,b){this.flvs.set(a,b);return this};M.prototype.removeFLV=function(a){this.flvs.delete(a);return this};M.prototype.addRule=function(a){this.rules.push(a);return this};M.prototype.removeRule=function(a){var b=this.rules;a=b.indexOf(a);b.splice(a,1);return this};
M.prototype.fuzzify=function(a,b){this.flvs.get(a).fuzzify(b);return this};M.prototype.defuzzify=function(a,b){b=void 0===b?M.DEFUZ_TYPE.MAXAV:b;var c=this.flvs,e=this.rules;this._initConsequences();for(var d=0,k=e.length;d<k;d++)e[d].evaluate();a=c.get(a);switch(b){case M.DEFUZ_TYPE.MAXAV:b=a.defuzzifyMaxAv();break;case M.DEFUZ_TYPE.CENTROID:b=a.defuzzifyCentroid();break;default:v.warn("YUKA.FuzzyModule: Unknown defuzzification method:",b),b=a.defuzzifyMaxAv()}return b};M.prototype._initConsequences=
function(){for(var a=this.rules,b=0,c=a.length;b<c;b++)a[b].initConsequence();return this};M.prototype.toJSON=function(){for(var a={rules:[],flvs:[]},b=this.rules,c=0,e=b.length;c<e;c++)a.rules.push(b[c].toJSON());b=$jscomp.makeIterator(this.flvs);for(c=b.next();!c.done;c=b.next())e=$jscomp.makeIterator(c.value),c=e.next().value,e=e.next().value,a.flvs.push({name:c,flv:e.toJSON()});return a};M.prototype.fromJSON=function(a){for(var b=new Map,c=a.flvs,e=0,d=c.length;e<d;e++){var k=c[e],f=k.name;k=
(new la).fromJSON(k.flv);this.addFLV(f,k);f=$jscomp.makeIterator(k.fuzzySets);for(k=f.next();!k.done;k=f.next())k=k.value,b.set(k.uuid,k)}a=a.rules;c=0;for(d=a.length;c<d;c++)e=a[c],e=(new Ka).fromJSON(e,b),this.addRule(e);return this};M.DEFUZ_TYPE=Object.freeze({MAXAV:0,CENTROID:1});var t=function(a){this.owner=void 0===a?null:a;this.status=t.STATUS.INACTIVE};t.prototype.activate=function(){};t.prototype.execute=function(){};t.prototype.terminate=function(){};t.prototype.handleMessage=function(){return!1};
t.prototype.active=function(){return this.status===t.STATUS.ACTIVE};t.prototype.inactive=function(){return this.status===t.STATUS.INACTIVE};t.prototype.completed=function(){return this.status===t.STATUS.COMPLETED};t.prototype.failed=function(){return this.status===t.STATUS.FAILED};t.prototype.replanIfFailed=function(){!0===this.failed()&&(this.status=t.STATUS.INACTIVE);return this};t.prototype.activateIfInactive=function(){!0===this.inactive()&&(this.activate(),this.status=t.STATUS.ACTIVE);return this};
t.prototype.toJSON=function(){return{type:this.constructor.name,owner:this.owner.uuid,status:this.status}};t.prototype.fromJSON=function(a){this.owner=a.owner;this.status=a.status;return this};t.prototype.resolveReferences=function(a){this.owner=a.get(this.owner)||null;return this};t.STATUS=Object.freeze({ACTIVE:"active",INACTIVE:"inactive",COMPLETED:"completed",FAILED:"failed"});var J=function(a){a=t.call(this,void 0===a?null:a)||this;a.subgoals=[];return a};$jscomp.inherits(J,t);J.prototype.addSubgoal=
function(a){this.subgoals.unshift(a);return this};J.prototype.removeSubgoal=function(a){a=this.subgoals.indexOf(a);this.subgoals.splice(a,1);return this};J.prototype.clearSubgoals=function(){for(var a=this.subgoals,b=0,c=a.length;b<c;b++)a[b].terminate();a.length=0;return this};J.prototype.currentSubgoal=function(){var a=this.subgoals.length;return 0<a?this.subgoals[a-1]:null};J.prototype.executeSubgoals=function(){for(var a=this.subgoals,b=a.length-1;0<=b;b--){var c=a[b];if(!0===c.completed()||!0===
c.failed())c instanceof J&&c.clearSubgoals(),c.terminate(),a.pop();else break}b=this.currentSubgoal();return null!==b?(b.activateIfInactive(),b.execute(),!0===b.completed()&&1<a.length?t.STATUS.ACTIVE:b.status):t.STATUS.COMPLETED};J.prototype.hasSubgoals=function(){return 0<this.subgoals.length};J.prototype.handleMessage=function(a){var b=this.currentSubgoal();return null!==b?b.handleMessage(a):!1};J.prototype.toJSON=function(){var a=t.prototype.toJSON.call(this);a.subgoals=[];for(var b=0,c=this.subgoals.length;b<
c;b++)a.subgoals.push(this.subgoals[b].toJSON());return a};J.prototype.resolveReferences=function(a){t.prototype.resolveReferences.call(this,a);for(var b=0,c=this.subgoals.length;b<c;b++)this.subgoals[b].resolveReferences(a);return this};var Ya=function(a){this.characterBias=void 0===a?1:a};Ya.prototype.calculateDesirability=function(){return 0};Ya.prototype.setGoal=function(){};Ya.prototype.toJSON=function(){return{type:this.constructor.name,characterBias:this.characterBias}};Ya.prototype.fromJSON=
function(a){this.characterBias=a.characterBias;return this};var T=function(a){a=J.call(this,void 0===a?null:a)||this;a.evaluators=[];a._typesMap=new Map;return a};$jscomp.inherits(T,J);T.prototype.activate=function(){this.arbitrate()};T.prototype.execute=function(){this.activateIfInactive();var a=this.executeSubgoals();if(a===t.STATUS.COMPLETED||a===t.STATUS.FAILED)this.status=t.STATUS.INACTIVE};T.prototype.terminate=function(){this.clearSubgoals()};T.prototype.addEvaluator=function(a){this.evaluators.push(a);
return this};T.prototype.removeEvaluator=function(a){a=this.evaluators.indexOf(a);this.evaluators.splice(a,1);return this};T.prototype.arbitrate=function(){for(var a=this.evaluators,b=-1,c=null,e=0,d=a.length;e<d;e++){var k=a[e],f=k.calculateDesirability(this.owner);f*=k.characterBias;f>=b&&(b=f,c=k)}null!==c?c.setGoal(this.owner):v.error("YUKA.Think: Unable to determine goal evaluator for game entity:",this.owner);return this};T.prototype.toJSON=function(){var a=J.prototype.toJSON.call(this);a.evaluators=
[];for(var b=0,c=this.evaluators.length;b<c;b++)a.evaluators.push(this.evaluators[b].toJSON());return a};T.prototype.fromJSON=function(a){function b(a){var e=a.type,d=c.get(e);if(void 0!==d){e=(new d).fromJSON(a);a=a.subgoals;if(void 0!==a){d=0;for(var k=a.length;d<k;d++){var f=b(a[d]);f&&e.subgoals.push(f)}}return e}v.warn("YUKA.Think: Unsupported goal evaluator type:",e)}J.prototype.fromJSON.call(this,a);var c=this._typesMap;this.evaluators.length=0;this.terminate();for(var e=0,d=a.evaluators.length;e<
d;e++){var k=a.evaluators[e],f=k.type,g=c.get(f);void 0!==g?(k=(new g).fromJSON(k),this.evaluators.push(k)):v.warn("YUKA.Think: Unsupported goal evaluator type:",f)}e=0;for(d=a.subgoals.length;e<d;e++)(k=b(a.subgoals[e]))&&this.subgoals.push(k);return this};T.prototype.registerType=function(a,b){this._typesMap.set(a,b);return this};var Y=function(a,b,c){this.from=void 0===a?-1:a;this.to=void 0===b?-1:b;this.cost=void 0===c?0:c};Y.prototype.copy=function(a){this.from=a.from;this.to=a.to;this.cost=
a.cost;return this};Y.prototype.clone=function(){return(new this.constructor).copy(this)};Y.prototype.toJSON=function(){return{type:this.constructor.name,from:this.from,to:this.to,cost:this.cost}};Y.prototype.fromJSON=function(a){this.from=a.from;this.to=a.to;this.cost=a.cost;return this};var La=function(a){this.index=void 0===a?-1:a};La.prototype.toJSON=function(){return{type:this.constructor.name,index:this.index}};La.prototype.fromJSON=function(a){this.index=a.index;return this};var E=function(){this.digraph=
!1;this._nodes=new Map;this._edges=new Map};E.prototype.addNode=function(a){var b=a.index;this._nodes.set(b,a);this._edges.set(b,[]);return this};E.prototype.addEdge=function(a){var b=this._edges.get(a.from);b.push(a);if(!1===this.digraph){var c=a.clone();c.from=a.to;c.to=a.from;b=this._edges.get(a.to);b.push(c)}return this};E.prototype.getNode=function(a){return this._nodes.get(a)||null};E.prototype.getEdge=function(a,b){if(this.hasNode(a)&&this.hasNode(b)){a=this._edges.get(a);for(var c=0,e=a.length;c<
e;c++){var d=a[c];if(d.to===b)return d}}return null};E.prototype.getNodes=function(a){a.length=0;a.push.apply(a,$jscomp.arrayFromIterable(this._nodes.values()));return a};E.prototype.getEdgesOfNode=function(a,b){a=this._edges.get(a);void 0!==a&&(b.length=0,b.push.apply(b,$jscomp.arrayFromIterable(a)));return b};E.prototype.getNodeCount=function(){return this._nodes.size};E.prototype.getEdgeCount=function(){for(var a=0,b=$jscomp.makeIterator(this._edges.values()),c=b.next();!c.done;c=b.next())a+=c.value.length;
return a};E.prototype.removeNode=function(a){this._nodes.delete(a.index);if(!1===this.digraph){var b=this._edges.get(a.index);b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next()){c=this._edges.get(c.value.to);for(var e=c.length-1;0<=e;e--){var d=c[e];if(d.to===a.index){e=c.indexOf(d);c.splice(e,1);break}}}}else for(b=$jscomp.makeIterator(this._edges.values()),c=b.next();!c.done;c=b.next())for(c=c.value,e=c.length-1;0<=e;e--)d=c[e],this.hasNode(d.to)&&this.hasNode(d.from)||(d=c.indexOf(d),
c.splice(d,1));this._edges.delete(a.index);return this};E.prototype.removeEdge=function(a){var b=this._edges.get(a.from);if(void 0!==b){var c=b.indexOf(a);b.splice(c,1);if(!1===this.digraph){b=this._edges.get(a.to);c=0;for(var e=b.length;c<e;c++){var d=b[c];if(d.to===a.from){a=b.indexOf(d);b.splice(a,1);break}}}}return this};E.prototype.hasNode=function(a){return this._nodes.has(a)};E.prototype.hasEdge=function(a,b){if(this.hasNode(a)&&this.hasNode(b)){a=this._edges.get(a);for(var c=0,e=a.length;c<
e;c++)if(a[c].to===b)return!0}return!1};E.prototype.clear=function(){this._nodes.clear();this._edges.clear();return this};E.prototype.toJSON=function(){for(var a={type:this.constructor.name,digraph:this.digraph},b=[],c=[],e=$jscomp.makeIterator(this._nodes.entries()),d=e.next();!d.done;d=e.next()){d=$jscomp.makeIterator(d.value);var k=d.next().value;d=d.next().value;var f=[];this.getEdgesOfNode(k,f);k=0;for(var g=f.length;k<g;k++)b.push(f[k].toJSON());c.push(d.toJSON())}a._edges=b;a._nodes=c;return a};
E.prototype.fromJSON=function(a){this.digraph=a.digraph;for(var b=0,c=a._nodes.length;b<c;b++)this.addNode((new La).fromJSON(a._nodes[b]));b=0;for(c=a._edges.length;b<c;b++)this.addEdge((new Y).fromJSON(a._edges[b]));return this};var Tb=function(){};Tb.calculate=function(a,b,c){b=a.getNode(b);a=a.getNode(c);return b.position.distanceTo(a.position)};var zc=function(){};zc.calculate=function(a,b,c){b=a.getNode(b);a=a.getNode(c);return b.position.squaredDistanceTo(a.position)};var Ac=function(){};Ac.calculate=
function(a,b,c){b=a.getNode(b);a=a.getNode(c);return b.position.manhattanDistanceTo(a.position)};var Bc=function(){};Bc.calculate=function(){return 0};var pa=function(a){a=void 0===a?r:a;this.data=[];this.length=0;this.compare=a};pa.prototype.push=function(a){this.data.push(a);this.length++;this._up(this.length-1)};pa.prototype.pop=function(){if(0===this.length)return null;var a=this.data[0];this.length--;0<this.length&&(this.data[0]=this.data[this.length],this._down(0));this.data.pop();return a};
pa.prototype.peek=function(){return this.data[0]||null};pa.prototype._up=function(a){for(var b=this.data,c=this.compare,e=b[a];0<a;){var d=a-1>>1,k=b[d];if(0<=c(e,k))break;b[a]=k;a=d}b[a]=e};pa.prototype._down=function(a){for(var b=this.data,c=this.compare,e=b[a],d=this.length>>1;a<d;){var k=(a<<1)+1,f=k+1,g=b[k];f<this.length&&0>c(b[f],g)&&(k=f,g=b[f]);if(0<=c(g,e))break;b[a]=g;a=k}b[a]=e};var Ma=function(a,b,c){this.graph=void 0===a?null:a;this.source=void 0===b?-1:b;this.target=void 0===c?-1:c;
this.found=!1;this.heuristic=Tb;this._cost=new Map;this._shortestPathTree=new Map;this._searchFrontier=new Map};Ma.prototype.search=function(){var a=[],b=new pa(n);for(b.push({cost:0,index:this.source});0<b.length;){var c=b.pop().index;if(!this._shortestPathTree.has(c)){!0===this._searchFrontier.has(c)&&this._shortestPathTree.set(c,this._searchFrontier.get(c));if(c===this.target)return this.found=!0,this;this.graph.getEdgesOfNode(c,a);for(var e=0,d=a.length;e<d;e++){var f=a[e],g=(this._cost.get(c)||
0)+f.cost,h=this.heuristic.calculate(this.graph,f.to,this.target);h=g+h;if(!1===this._searchFrontier.has(f.to)||g<this._cost.get(f.to))this._cost.set(f.to,g),this._searchFrontier.set(f.to,f),b.push({cost:h,index:f.to})}}}this.found=!1;return this};Ma.prototype.getPath=function(){var a=[];if(!1===this.found||-1===this.target)return a;var b=this.target;for(a.push(b);b!==this.source;)b=this._shortestPathTree.get(b).from,a.unshift(b);return a};Ma.prototype.getSearchTree=function(){return[].concat($jscomp.arrayFromIterable(this._shortestPathTree.values()))};
Ma.prototype.clear=function(){this.found=!1;this._cost.clear();this._shortestPathTree.clear();this._searchFrontier.clear();return this};var Za=function(a,b,c){this.graph=void 0===a?null:a;this.source=void 0===b?-1:b;this.target=void 0===c?-1:c;this.found=!1;this._route=new Map;this._visited=new Set;this._spanningTree=new Set};Za.prototype.search=function(){var a=[],b=[],c=new Y(this.source,this.source);a.push(c);for(this._visited.add(this.source);0<a.length;){var e=a.shift();this._route.set(e.to,
e.from);e!==c&&this._spanningTree.add(e);if(e.to===this.target)return this.found=!0,this;this.graph.getEdgesOfNode(e.to,b);e=0;for(var d=b.length;e<d;e++){var f=b[e];!1===this._visited.has(f.to)&&(a.push(f),this._visited.add(f.to))}}this.found=!1;return this};Za.prototype.getPath=function(){var a=[];if(!1===this.found||-1===this.target)return a;var b=this.target;for(a.push(b);b!==this.source;)b=this._route.get(b),a.unshift(b);return a};Za.prototype.getSearchTree=function(){return[].concat($jscomp.arrayFromIterable(this._spanningTree))};
Za.prototype.clear=function(){this.found=!1;this._route.clear();this._visited.clear();this._spanningTree.clear();return this};var $a=function(a,b,c){this.graph=void 0===a?null:a;this.source=void 0===b?-1:b;this.target=void 0===c?-1:c;this.found=!1;this._route=new Map;this._visited=new Set;this._spanningTree=new Set};$a.prototype.search=function(){var a=[],b=[],c=new Y(this.source,this.source);for(a.push(c);0<a.length;){var e=a.pop();this._route.set(e.to,e.from);this._visited.add(e.to);e!==c&&this._spanningTree.add(e);
if(e.to===this.target)return this.found=!0,this;this.graph.getEdgesOfNode(e.to,b);e=0;for(var d=b.length;e<d;e++){var f=b[e];!1===this._visited.has(f.to)&&a.push(f)}}this.found=!1;return this};$a.prototype.getPath=function(){var a=[];if(!1===this.found||-1===this.target)return a;var b=this.target;for(a.push(b);b!==this.source;)b=this._route.get(b),a.unshift(b);return a};$a.prototype.getSearchTree=function(){return[].concat($jscomp.arrayFromIterable(this._spanningTree))};$a.prototype.clear=function(){this.found=
!1;this._route.clear();this._visited.clear();this._spanningTree.clear();return this};var ab=function(a,b,c){this.graph=void 0===a?null:a;this.source=void 0===b?-1:b;this.target=void 0===c?-1:c;this.found=!1;this._cost=new Map;this._shortestPathTree=new Map;this._searchFrontier=new Map};ab.prototype.search=function(){var a=[],b=new pa(F);for(b.push({cost:0,index:this.source});0<b.length;){var c=b.pop().index;if(!this._shortestPathTree.has(c)){!0===this._searchFrontier.has(c)&&this._shortestPathTree.set(c,
this._searchFrontier.get(c));if(c===this.target)return this.found=!0,this;this.graph.getEdgesOfNode(c,a);for(var e=0,d=a.length;e<d;e++){var f=a[e],g=(this._cost.get(c)||0)+f.cost;if(!1===this._searchFrontier.has(f.to)||g<this._cost.get(f.to))this._cost.set(f.to,g),this._searchFrontier.set(f.to,f),b.push({cost:g,index:f.to})}}}this.found=!1;return this};ab.prototype.getPath=function(){var a=[];if(!1===this.found||-1===this.target)return a;var b=this.target;for(a.push(b);b!==this.source;)b=this._shortestPathTree.get(b).from,
a.unshift(b);return a};ab.prototype.getSearchTree=function(){return[].concat($jscomp.arrayFromIterable(this._shortestPathTree.values()))};ab.prototype.clear=function(){this.found=!1;this._cost.clear();this._shortestPathTree.clear();this._searchFrontier.clear();return this};var Cc=new g,yb=new g,Z=function(a,b){a=void 0===a?new g:a;b=void 0===b?new g:b;this.from=a;this.to=b};Z.prototype.set=function(a,b){this.from=a;this.to=b;return this};Z.prototype.copy=function(a){this.from.copy(a.from);this.to.copy(a.to);
return this};Z.prototype.clone=function(){return(new this.constructor).copy(this)};Z.prototype.delta=function(a){return a.subVectors(this.to,this.from)};Z.prototype.at=function(a,b){return this.delta(b).multiplyScalar(a).add(this.from)};Z.prototype.closestPointToPoint=function(a,b,c){a=this.closestPointToPointParameter(a,b);return this.at(a,c)};Z.prototype.closestPointToPointParameter=function(a,b){b=void 0===b?!0:b;Cc.subVectors(a,this.from);yb.subVectors(this.to,this.from);a=yb.dot(yb);a=yb.dot(Cc)/
a;b&&(a=w.clamp(a,0,1));return a};Z.prototype.equals=function(a){return a.from.equals(this.from)&&a.to.equals(this.to)};var Dc=new g,Qc=new g,aa=function(a,b){this.normal=a=void 0===a?new g(0,0,1):a;this.constant=void 0===b?0:b};aa.prototype.set=function(a,b){this.normal=a;this.constant=b;return this};aa.prototype.copy=function(a){this.normal.copy(a.normal);this.constant=a.constant;return this};aa.prototype.clone=function(){return(new this.constructor).copy(this)};aa.prototype.distanceToPoint=function(a){return this.normal.dot(a)+
this.constant};aa.prototype.fromNormalAndCoplanarPoint=function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this};aa.prototype.fromCoplanarPoints=function(a,b,c){Dc.subVectors(c,b).cross(Qc.subVectors(a,b)).normalize();this.fromNormalAndCoplanarPoint(Dc,a);return this};aa.prototype.equals=function(a){return a.normal.equals(this.normal)&&a.constant===this.constant};var zb=function(a,b,c){return Y.call(this,void 0===a?-1:a,void 0===b?-1:b,void 0===c?0:c)||this};$jscomp.inherits(zb,
Y);var Ab=function(a,b,c){a=void 0===a?-1:a;b=void 0===b?new g:b;c=void 0===c?{}:c;a=La.call(this,a)||this;a.position=b;a.userData=c;return a};$jscomp.inherits(Ab,La);var Ec=function(){};Ec.createGridLayout=function(a,b){var c=new E;c.digraph=!0;var e=a/2;a/=b;for(var d=0,f=0;f<=b;f++)for(var p=f*a-e,h=0;h<=b;h++){var m=new g(h*a-e,0,p);m=new Ab(d,m);c.addNode(m);d++}b=c.getNodeCount();e=Math.pow(a+a/2,2);for(a=0;a<b;a++)for(d=c.getNode(a),f=0;f<b;f++)a!==f&&(p=c.getNode(f).position.squaredDistanceTo(d.position),
p<=e&&(p=new zb(a,f,Math.sqrt(p)),c.addEdge(p)));return c};var Bb=function(){this.portalEdges=[]};Bb.prototype.push=function(a,b){this.portalEdges.push({left:a,right:b});return this};Bb.prototype.generate=function(){var a=this.portalEdges,b=[],c=0,e=0;var d=a[0].left;var f=a[0].left;var g=a[0].right;b.push(d);var h=1;for(var m=a.length;h<m;h++){var n=a[h].left,l=a[h].right;if(0>=w.area(d,g,l))if(d===g||0<w.area(d,f,l))g=l,e=h;else{b.push(f);d=f;h=c;g=f=d;e=c=h;continue}0<=w.area(d,f,n)&&(d===f||0>
w.area(d,g,n)?(f=n,c=h):(b.push(g),d=g,h=e,g=f=d,e=c=h))}0!==b.length&&b[b.length-1]===a[a.length-1].left||b.push(a[a.length-1].left);return b};var Na=function(a){this.vertex=a=void 0===a?new g:a;this.polygon=this.twin=this.prev=this.next=null;this.nodeIndex=-1};Na.prototype.from=function(){return this.vertex};Na.prototype.to=function(){return this.next?this.next.vertex:null};Na.prototype.length=function(){var a=this.from(),b=this.to();return null!==b?a.distanceTo(b):-1};Na.prototype.squaredLength=
function(){var a=this.from(),b=this.to();return null!==b?a.squaredDistanceTo(b):-1};var Ub=new g,Fc=new g,Vb=new g,Wb=new g,bb=new g,cb=new Z,R=function(){this.graph=new E;this.graph.digraph=!0;this.regions=[];this.spatialIndex=null;this.epsilonCoplanarTest=.001;this.epsilonContainsTest=1};R.prototype.fromPolygons=function(a){this.clear();for(var b=[],c=[],e=0,d=a.length;e<d;e++){var f=a[e],g=f.edge;do b.push(g),g=g.next;while(g!==f.edge);this.regions.push(f)}a=0;for(e=b.length;a<e;a++)if(d=b[a],
null===d.twin)for(f=a+1,g=b.length;f<g;f++){var h=b[f];if(d.from().equals(h.to())&&d.to().equals(h.from())){d.twin=h;h.twin=d;f=d.squaredLength();c.push({cost:f,edge:d});break}}c.sort(l);this._buildRegions(c);this._buildNodeIndices();this._buildGraph();return this};R.prototype.clear=function(){this.graph.clear();this.regions.length=0;this.spatialIndex=null;return this};R.prototype.getClosestRegion=function(a){for(var b=this.regions,c=null,e=Infinity,d=0,f=b.length;d<f;d++){var g=b[d],h=a.squaredDistanceTo(g.centroid);
h<e&&(e=h,c=g)}return c};R.prototype.getRandomRegion=function(){var a=this.regions,b=Math.floor(Math.random()*a.length);b===a.length&&(b=a.length-1);return a[b]};R.prototype.getRegionForPoint=function(a,b){b=void 0===b?.001:b;if(null!==this.spatialIndex){var c=this.spatialIndex.getIndexForPosition(a);c=this.spatialIndex.cells[c].entries}else c=this.regions;for(var d=0,f=c.length;d<f;d++){var g=c[d];if(!0===g.contains(a,b))return g}return null};R.prototype.findPath=function(a,b){var c=this.graph,d=
[],f=this.getRegionForPoint(a,this.epsilonContainsTest),k=this.getRegionForPoint(b,this.epsilonContainsTest);if(null===f||null===k)null===f&&(f=this.getClosestRegion(a)),null===k&&(k=this.getClosestRegion(b));if(f===k)d.push((new g).copy(a)),d.push((new g).copy(b));else if(f=this.regions.indexOf(f),k=this.regions.indexOf(k),c=new Ma(c,f,k),c.search(),!0===c.found){c=c.getPath();k=new Bb;k.push(a,a);a={left:null,right:null};f=0;for(var p=c.length-1;f<p;f++)this.regions[c[f]].getPortalEdgeTo(this.regions[c[f+
1]],a),k.push(a.left,a.right);k.push(b,b);d.push.apply(d,$jscomp.arrayFromIterable(k.generate()))}return d};R.prototype.clampMovement=function(a,b,c,d){var e=this.getRegionForPoint(c,this.epsilonContainsTest);if(null===e){if(null===a)throw Error("YUKA.NavMesh.clampMovement(): No current region available.");e=null;var f=Infinity,g=a.edge;do{if(null===g.twin){cb.set(g.vertex,g.next.vertex);var h=cb.closestPointToPointParameter(b);cb.at(h,Ub);h=Ub.squaredDistanceTo(b);h<f&&(f=h,e=g,Fc.copy(Ub))}g=g.next}while(g!==
a.edge);Vb.subVectors(e.next.vertex,e.vertex).normalize();c=Wb.subVectors(c,b).length();Wb.divideScalar(c);f=Vb.dot(Wb);bb.copy(Fc).add(Vb.multiplyScalar(f*c));cb.set(e.vertex,e.next.vertex);e=cb.closestPointToPointParameter(bb,!1);if(0<=e&&1>=e)d.copy(bb);else{e=this.getRegionForPoint(bb,this.epsilonContainsTest);if(null!==e)return d.copy(bb),e;d.copy(b)}return a}return e};R.prototype.updateSpatialIndex=function(){if(null!==this.spatialIndex){this.spatialIndex.makeEmpty();for(var a=this.regions,
b=0,c=a.length;b<c;b++)this.spatialIndex.addPolygon(a[b])}return this};R.prototype._buildRegions=function(a){for(var b=this.regions,c,d,f,g,h=0,m=a.length;h<m;h++){var n=a[h],l=n.edge;c=l.prev;d=l.next;f=l.twin.prev;g=l.twin.next;l.prev.next=l.twin.next;l.next.prev=l.twin.prev;l.twin.prev.next=l.next;l.twin.next.prev=l.prev;var q=l.polygon;q.edge=l.prev;if(!0===q.convex()&&!0===q.coplanar(this.epsilonCoplanarTest)){c=q.edge;do c.polygon=q,c=c.next;while(c!==q.edge);n=b.indexOf(n.edge.twin.polygon);
b.splice(n,1)}else c.next=l,d.prev=l,f.next=l.twin,g.prev=l.twin,q.edge=l}a=0;for(m=b.length;a<m;a++)b[a].computeCentroid()};R.prototype._buildNodeIndices=function(){for(var a=this.regions,b=new Map,c=0,d=0,f=a.length;d<f;d++){var g=a[d],h=g.edge;do{if(null!==h.twin&&null===h.nodeIndex){for(var l=-1,m=h.from(),n=$jscomp.makeIterator(b.entries()),q=n.next();!q.done;q=n.next()){var r=$jscomp.makeIterator(q.value);q=r.next().value;r=r.next().value;if(!0===m.equals(r)){l=q;break}}-1===l&&(l=c++,b.set(l,
m));h.nodeIndex=l;h.twin.next.nodeIndex=l}h=h.next}while(h!==g.edge)}};R.prototype._buildGraph=function(){for(var a=this.graph,b=this.regions,c=[],d=0,f=b.length;d<f;d++){var g=b[d],h=[];c.push(h);var l=g.edge;do null!==l.twin&&(h.push(this.regions.indexOf(l.twin.polygon)),!1===a.hasNode(this.regions.indexOf(l.polygon))&&a.addNode(new Ab(this.regions.indexOf(l.polygon),l.polygon.centroid))),l=l.next;while(l!==g.edge)}b=0;for(d=c.length;b<d;b++)for(f=c[b],g=b,h=0,l=f.length;h<l;h++){var m=f[h];if(g!==
m&&!1===a.hasEdge(g,m)){var n=a.getNode(g),q=a.getNode(m);n=n.position.distanceTo(q.position);a.addEdge(new zb(g,m,n))}}return this};var ba=function(){this.centroid=new g;this.edge=null;this.plane=new aa};ba.prototype.fromContour=function(a){var b=[];if(3>a.length)return v.error("YUKA.Polygon: Unable to create polygon from contour. It needs at least three points."),this;for(var c=0,d=a.length;c<d;c++){var f=new Na(a[c]);b.push(f)}c=0;for(d=b.length;c<d;c++){if(0===c){f=b[c];var g=b[d-1];var h=b[c+
1]}else c===d-1?(f=b[c],g=b[c-1],h=b[0]):(f=b[c],g=b[c-1],h=b[c+1]);f.prev=g;f.next=h;f.polygon=this}this.edge=b[0];this.plane.fromCoplanarPoints(a[0],a[1],a[2]);return this};ba.prototype.computeCentroid=function(){var a=this.centroid,b=this.edge,c=0;a.set(0,0,0);do a.add(b.from()),c++,b=b.next;while(b!==this.edge);a.divideScalar(c);return this};ba.prototype.contains=function(a,b){b=void 0===b?.001:b;var c=this.plane,d=this.edge;do{var f=d.from(),g=d.to();if(!1===0<=w.area(f,g,a))return!1;d=d.next}while(d!==
this.edge);a=c.distanceToPoint(a);return Math.abs(a)>b?!1:!0};ba.prototype.convex=function(){var a=this.edge;do{var b=a.from(),c=a.to(),d=a.next.to();if(!1===0<=w.area(b,c,d))return!1;a=a.next}while(a!==this.edge);return!0};ba.prototype.coplanar=function(a){a=void 0===a?.001:a;var b=this.plane,c=this.edge;do{var d=b.distanceToPoint(c.from());if(Math.abs(d)>a)return!1;c=c.next}while(c!==this.edge);return!0};ba.prototype.getContour=function(a){var b=this.edge;a.length=0;do a.push(b.vertex),b=b.next;
while(b!==this.edge);return a};ba.prototype.getPortalEdgeTo=function(a,b){var c=this.edge;do{if(null!==c.twin&&c.twin.polygon===a)return b.left=c.vertex,b.right=c.next.vertex,b;c=c.next}while(c!==this.edge);b.left=null;b.right=null;return b};var Gc=function(){};Gc.prototype.load=function(a,b){return new Promise(function(c,d){fetch(a).then(function(a){if(200<=a.status&&300>a.status)return a.arrayBuffer();var b=Error(a.statusText||a.status);b.response=a;return Promise.reject(b)}).then(function(c){var d=
new ca,e=new TextDecoder;"glTF"===e.decode(new Uint8Array(c,0,4))?(d.parseBinary(c),c=d.extensions.get("BINARY").content):c=e.decode(new Uint8Array(c));c=JSON.parse(c);if(void 0===c.asset||2>c.asset.version[0])throw Error("YUKA.NavMeshLoader: Unsupported asset version.");e=a.lastIndexOf("/");e=-1===e?"./":a.substr(0,e+1);return d.parse(c,e,b)}).then(function(a){c(a)}).catch(function(a){v.error("YUKA.NavMeshLoader: Unable to load navigation mesh.",a);d(a)})})};var ca=function(){this.path=this.json=
null;this.cache=new Map;this.extensions=new Map};ca.prototype.parse=function(a,b,c){var d=this;this.json=a;this.path=b;return this.getDependency("mesh",0).then(function(a){a=d.parseGeometry(a);var b=new R;c&&c.epsilonCoplanarTest&&(b.epsilonCoplanarTest=c.epsilonCoplanarTest);return b.fromPolygons(a)})};ca.prototype.parseGeometry=function(a){var b=a.index,c=a.position;a=[];for(var d=[],f=0,k=c.length;f<k;f+=3){var h=new g;h.x=c[f+0];h.y=c[f+1];h.z=c[f+2];a.push(h)}if(b)for(c=0,k=b.length;c<k;c+=3)f=
[a[b[c+0]],a[b[c+1]],a[b[c+2]]],f=(new ba).fromContour(f),d.push(f);else for(b=0,k=a.length;b<k;b+=3)c=[a[b+0],a[b+1],a[b+2]],c=(new ba).fromContour(c),d.push(c);return d};ca.prototype.getDependencies=function(a){var b=this,c=this.cache,d=c.get(a);d||(d=Promise.all((this.json[a+("mesh"===a?"es":"s")]||[]).map(function(c,d){return b.getDependency(a,d)})),c.set(a,d));return d};ca.prototype.getDependency=function(a,b){var c=this.cache,d=a+":"+b,f=c.get(d);if(void 0===f){switch(a){case "accessor":f=this.loadAccessor(b);
break;case "buffer":f=this.loadBuffer(b);break;case "bufferView":f=this.loadBufferView(b);break;case "mesh":f=this.loadMesh(b);break;default:throw Error("Unknown type: "+a);}c.set(d,f)}return f};ca.prototype.loadBuffer=function(a){var b=this,c=this.json.buffers[a];return void 0===c.uri&&0===a?Promise.resolve(this.extensions.get("BINARY").body):new Promise(function(a,d){var e=fb(c.uri,b.path);fetch(e).then(function(a){return a.arrayBuffer()}).then(function(b){a(b)}).catch(function(a){v.error("YUKA.NavMeshLoader: Unable to load buffer.",
a);d(a)})})};ca.prototype.loadBufferView=function(a){var b=this.json.bufferViews[a];return this.getDependency("buffer",b.buffer).then(function(a){var c=b.byteOffset||0;return a.slice(c,c+(b.byteLength||0))})};ca.prototype.loadAccessor=function(a){var b=this.json.accessors[a];return this.getDependency("bufferView",b.bufferView).then(function(a){return new Rc[b.componentType](a,b.byteOffset||0,b.count*Sc[b.type])})};ca.prototype.loadMesh=function(a){var b=this.json.meshes[a];return this.getDependencies("accessor").then(function(a){var c=
b.primitives[0];if(4!==c.mode)throw Error("YUKA.NavMeshLoader: Invalid geometry format. Please ensure to represent your geometry as triangles.");return{index:a[c.indices],position:a[c.attributes.POSITION],normal:a[c.attributes.NORMAL]}})};ca.prototype.parseBinary=function(a){for(var b=new DataView(a,12),c=0,d=new TextDecoder,f=null,g=null;c<b.byteLength;){var h=b.getUint32(c,!0);c+=4;var l=b.getUint32(c,!0);c+=4;l===Hc.JSON?(f=new Uint8Array(a,12+c,h),f=d.decode(f)):l===Hc.BIN&&(g=12+c,g=a.slice(g,
g+h));c+=h}this.extensions.set("BINARY",{content:f,body:g})};var Sc={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Rc={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Hc={JSON:1313821514,BIN:5130562},U=function(a){this.aabb=a=void 0===a?new C:a;this.entries=[]};U.prototype.add=function(a){this.entries.push(a);return this};U.prototype.remove=function(a){a=this.entries.indexOf(a);this.entries.splice(a,1);return this};U.prototype.makeEmpty=function(){this.entries.length=
0;return this};U.prototype.empty=function(){return 0===this.entries.length};U.prototype.intersects=function(a){return this.aabb.intersectsAABB(a)};U.prototype.toJSON=function(){for(var a={type:this.constructor.name,aabb:this.aabb.toJSON(),entries:[]},b=this.entries,c=0,d=b.length;c<d;c++)a.entries.push(b[c].uuid);return a};U.prototype.fromJSON=function(a){this.aabb.fromJSON(a.aabb);this.entries=a.entries.slice();return this};U.prototype.resolveReferences=function(a){for(var b=this.entries,c=0,d=b.length;c<
d;c++)b[c]=a.get(b[c]);return this};var Cb=new g,db=new C,Ic=[],V=function(a,b,c,d,f,h){this.cells=[];this.width=a;this.height=b;this.depth=c;this.cellsX=d;this.cellsY=f;this.cellsZ=h;this._halfWidth=this.width/2;this._halfHeight=this.height/2;this._halfDepth=this.depth/2;this._min=new g(-this._halfWidth,-this._halfHeight,-this._halfDepth);this._max=new g(this._halfWidth,this._halfHeight,this._halfDepth);a=this.width/this.cellsX;b=this.height/this.cellsY;c=this.depth/this.cellsZ;for(d=0;d<this.cellsX;d++)for(f=
d*a-this._halfWidth,h=0;h<this.cellsY;h++)for(var e=h*b-this._halfHeight,k=0;k<this.cellsZ;k++){var l=k*c-this._halfDepth,m=new g,n=new g;m.set(f,e,l);n.x=m.x+a;n.y=m.y+b;n.z=m.z+c;l=new C(m,n);l=new U(l);this.cells.push(l)}};V.prototype.updateEntity=function(a,b){b=void 0===b?-1:b;var c=this.getIndexForPosition(a.position);b!==c&&(this.addEntityToPartition(a,c),-1!==b&&this.removeEntityFromPartition(a,b));return c};V.prototype.addEntityToPartition=function(a,b){this.cells[b].add(a);return this};
V.prototype.removeEntityFromPartition=function(a,b){this.cells[b].remove(a);return this};V.prototype.getIndexForPosition=function(a){Cb.copy(a).clamp(this._min,this._max);a=Math.abs(Math.floor(this.cellsX*(Cb.x+this._halfWidth)/this.width));var b=Math.abs(Math.floor(this.cellsY*(Cb.y+this._halfHeight)/this.height)),c=Math.abs(Math.floor(this.cellsZ*(Cb.z+this._halfDepth)/this.depth));a===this.cellsX&&(a=this.cellsX-1);b===this.cellsY&&(b=this.cellsY-1);c===this.cellsZ&&(c=this.cellsZ-1);return a*
this.cellsY*this.cellsZ+b*this.cellsZ+c};V.prototype.query=function(a,b,c){var d=this.cells;c.length=0;db.min.copy(a).subScalar(b);db.max.copy(a).addScalar(b);a=0;for(b=d.length;a<b;a++){var f=d[a];!1===f.empty()&&!0===f.intersects(db)&&c.push.apply(c,$jscomp.arrayFromIterable(f.entries))}return c};V.prototype.makeEmpty=function(){for(var a=this.cells,b=0,c=a.length;b<c;b++)a[b].makeEmpty();return this};V.prototype.addPolygon=function(a){var b=this.cells;a.getContour(Ic);db.fromPoints(Ic);for(var c=
0,d=b.length;c<d;c++){var f=b[c];!0===f.intersects(db)&&f.add(a)}return this};V.prototype.toJSON=function(){for(var a={type:this.constructor.name,cells:[],width:this.width,height:this.height,depth:this.depth,cellsX:this.cellsX,cellsY:this.cellsY,cellsZ:this.cellsZ,_halfWidth:this._halfWidth,_halfHeight:this._halfHeight,_halfDepth:this._halfDepth,_min:this._min.toArray([]),_max:this._max.toArray([])},b=0,c=this.cells.length;b<c;b++)a.cells.push(this.cells[b].toJSON());return a};V.prototype.fromJSON=
function(a){this.cells.length=0;this.width=a.width;this.height=a.height;this.depth=a.depth;this.cellsX=a.cellsX;this.cellsY=a.cellsY;this.cellsZ=a.cellsZ;this._halfWidth=a._halfWidth;this._halfDepth=this._halfHeight=a._halfHeight;this._min.fromArray(a._min);this._max.fromArray(a._max);for(var b=0,c=a.cells.length;b<c;b++)this.cells.push((new U).fromJSON(a.cells[b]));return this};V.prototype.resolveReferences=function(a){for(var b=0,c=this.cells.length;b<c;b++)this.cells[b].resolveReferences(a)};var Oa=
function(a){this.entity=void 0===a?null:a;this.timeLastSensed=-1;this.lastSensedPosition=new g;this.visible=!1};Oa.prototype.toJSON=function(){return{type:this.constructor.name,entity:this.entity.uuid,timeLastSensed:this.timeLastSensed,lastSensedPosition:this.lastSensedPosition.toArray([]),visible:this.visible}};Oa.prototype.fromJSON=function(a){this.entity=a.entity;this.timeLastSensed=a.timeLastSensed;this.lastSensedPosition.fromArray(a.lastSensedPosition);this.visible=a.visible;return this};Oa.prototype.resolveReferences=
function(a){this.entity=a.get(this.entity)||null;return this};var da=function(a){this.owner=void 0===a?null:a;this.records=[];this.recordsMap=new Map;this.memorySpan=1};da.prototype.getRecord=function(a){return this.recordsMap.get(a)};da.prototype.createRecord=function(a){var b=new Oa(a);this.records.push(b);this.recordsMap.set(a,b);return this};da.prototype.deleteRecord=function(a){var b=this.getRecord(a);b=this.records.indexOf(b);this.records.splice(b,1);this.recordsMap.delete(a);return this};da.prototype.hasRecord=
function(a){return this.recordsMap.has(a)};da.prototype.clear=function(){this.records.length=0;this.recordsMap.clear();return this};da.prototype.getValidMemoryRecords=function(a,b){for(var c=this.records,d=b.length=0,f=c.length;d<f;d++){var g=c[d];a-g.timeLastSensed<=this.memorySpan&&b.push(g)}return b};da.prototype.toJSON=function(){for(var a={type:this.constructor.name,owner:this.owner.uuid,records:[],memorySpan:this.memorySpan},b=this.records,c=0,d=b.length;c<d;c++)a.records.push(b[c].toJSON());
return a};da.prototype.fromJSON=function(a){this.owner=a.owner;this.memorySpan=a.memorySpan;a=a.records;for(var b=0,c=a.length;b<c;b++){var d=a[b];d=(new Oa).fromJSON(d);this.records.push(d)}return this};da.prototype.resolveReferences=function(a){this.owner=a.get(this.owner)||null;for(var b=this.records,c=0,d=b.length;c<d;c++){var f=b[c];f.resolveReferences(a);this.recordsMap.set(f.entity,f)}return this};var Jc=new H,N={a:new g,b:new g,c:new g},Kc=new g,Db=new P,Eb=new aa,Lc=new A,eb=function(a){a=
void 0===a?new Xa:a;var b=u.call(this)||this;b.geometry=a;return b};$jscomp.inherits(eb,u);eb.prototype.intersectRay=function(a,b,c){c=void 0===c?null:c;var d=this.geometry;Jc.copy(d.boundingSphere).applyMatrix4(this.worldMatrix);if(null!==a.intersectBoundingSphere(Jc,Kc)&&(this.worldMatrix.getInverse(Lc),Db.copy(a).applyMatrix4(Lc),null!==Db.intersectAABB(d.aabb,Kc))){a=d.vertices;var f=d.indices;if(null===f){f=0;for(var g=a.length;f<g;f+=9)if(N.a.set(a[f],a[f+1],a[f+2]),N.b.set(a[f+3],a[f+4],a[f+
5]),N.c.set(a[f+6],a[f+7],a[f+8]),null!==Db.intersectTriangle(N,d.backfaceCulling,b))return b.applyMatrix4(this.worldMatrix),null!==c&&(Eb.fromCoplanarPoints(N.a,N.b,N.c),c.copy(Eb.normal),c.transformDirection(this.worldMatrix)),b}else{var h=0;for(g=f.length;h<g;h+=3){var l=f[h],m=f[h+1],n=f[h+2];N.a.set(a[3*l],a[3*l+1],a[3*l+2]);N.b.set(a[3*m],a[3*m+1],a[3*m+2]);N.c.set(a[3*n],a[3*n+1],a[3*n+2]);if(null!==Db.intersectTriangle(N,d.backfaceCulling,b))return b.applyMatrix4(this.worldMatrix),null!==
c&&(Eb.fromCoplanarPoints(N.a,N.b,N.c),c.copy(Eb.normal),c.transformDirection(this.worldMatrix)),b}}}return null};eb.prototype.toJSON=function(){var a=u.prototype.toJSON.call(this);a.geometry=this.geometry.toJSON();return a};eb.prototype.fromJSON=function(a){u.prototype.fromJSON.call(this,a);this.geometry.fromJSON(a.geometry);return this};var Fb=new g,Mc=new g,Xb=new P,Nc=new g,ya=function(a){this.owner=void 0===a?null:a;this.fieldOfView=Math.PI;this.range=Infinity;this.obstacles=[]};ya.prototype.addObstacle=
function(a){this.obstacles.push(a);return this};ya.prototype.removeObstacle=function(a){a=this.obstacles.indexOf(a);this.obstacles.splice(a,1);return this};ya.prototype.visible=function(a){var b=this.owner,c=this.obstacles;Fb.subVectors(a,b.position);a=Fb.length();if(a>this.range)return!1;b.getDirection(Mc);if(Mc.angleTo(Fb)>.5*this.fieldOfView)return!1;Xb.origin.copy(b.position);Xb.direction.copy(Fb).divideScalar(a||1);for(var d=0,f=c.length;d<f;d++)if(null!==c[d].intersectRay(Xb,Nc)&&Nc.squaredDistanceTo(b.position)<=
a*a)return!1;return!0};ya.prototype.toJSON=function(){for(var a={type:this.constructor.name,owner:this.owner.uuid,fieldOfView:this.fieldOfView,range:this.range.toString(),obstacles:[]},b=0,c=this.obstacles.length;b<c;b++)a.obstacles.push(this.obstacles[b].uuid);return a};ya.prototype.fromJSON=function(a){this.owner=a.owner;this.fieldOfView=a.fieldOfView;this.range=parseFloat(a.range);for(var b=0,c=a.obstacles.length;b<c;b++)this.obstacles.push(a.obstacles[b]);return this};ya.prototype.resolveReferences=
function(a){this.owner=a.get(this.owner)||null;for(var b=this.obstacles,c=0,d=b.length;c<d;c++)b[c]=a.get(b[c]);return this};var Oc=function(){};Oc.prototype.execute=function(){};var Yb=function(){this.tasks=[];this.options={timeout:1E3};this._active=!1;this._handler=m.bind(this);this._taskHandle=0};Yb.prototype.enqueue=function(a){this.tasks.push(a);return this};Yb.prototype.update=function(){0<this.tasks.length?!1===this._active&&(this._taskHandle=requestIdleCallback(this._handler,this.options),
this._active=!0):this._active=!1;return this};d.EntityManager=K;d.EventDispatcher=Wa;d.GameEntity=u;d.Logger=v;d.MeshGeometry=Xa;d.MessageDispatcher=X;d.MovingEntity=O;d.Regulator=yc;d.Time=Da;d.Telegram=W;d.State=ja;d.StateMachine=L;d.FuzzyAND=wb;d.FuzzyFAIRLY=Ea;d.FuzzyOR=xb;d.FuzzyVERY=Fa;d.LeftShoulderFuzzySet=Ga;d.RightShoulderFuzzySet=Ha;d.SingletonFuzzySet=Ia;d.TriangularFuzzySet=Ja;d.FuzzyCompositeTerm=I;d.FuzzyModule=M;d.FuzzyRule=Ka;d.FuzzySet=B;d.FuzzyTerm=ka;d.FuzzyVariable=la;d.CompositeGoal=
J;d.Goal=t;d.GoalEvaluator=Ya;d.Think=T;d.Edge=Y;d.Graph=E;d.Node=La;d.PriorityQueue=pa;d.AStar=Ma;d.BFS=Za;d.DFS=$a;d.Dijkstra=ab;d.AABB=C;d.BoundingSphere=H;d.LineSegment=Z;d.MathUtils=w;d.Matrix3=D;d.Matrix4=A;d.Plane=aa;d.Quaternion=z;d.Ray=P;d.Vector3=g;d.NavEdge=zb;d.NavNode=Ab;d.GraphUtils=Ec;d.Corridor=Bb;d.HalfEdge=Na;d.NavMesh=R;d.NavMeshLoader=Gc;d.Polygon=ba;d.Cell=U;d.CellSpacePartitioning=V;d.MemoryRecord=Oa;d.MemorySystem=da;d.Obstacle=eb;d.Vision=ya;d.Path=ha;d.Smoother=Ta;d.SteeringBehavior=
q;d.SteeringManager=Q;d.Vehicle=wa;d.AlignmentBehavior=lb;d.ArriveBehavior=ea;d.CohesionBehavior=nb;d.EvadeBehavior=ra;d.FleeBehavior=qa;d.FollowPathBehavior=za;d.InterposeBehavior=sa;d.ObstacleAvoidanceBehavior=ta;d.OffsetPursuitBehavior=ua;d.PursuitBehavior=va;d.SeekBehavior=fa;d.SeparationBehavior=tb;d.WanderBehavior=Ba;d.Task=Oc;d.TaskQueue=Yb;d.RectangularTriggerRegion=na;d.SphericalTriggerRegion=xa;d.TriggerRegion=S;d.Trigger=oa;d.HeuristicPolicyEuclid=Tb;d.HeuristicPolicyEuclidSquared=zc;d.HeuristicPolicyManhattan=
Ac;d.HeuristicPolicyDijkstra=Bc;d.WorldUp=Gb;Object.defineProperty(d,"__esModule",{value:!0})});
